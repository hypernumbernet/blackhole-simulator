\documentclass[a4paper,12pt,notitlepage]{jsreport}
\usepackage[left=10truemm,right=10truemm,top=25truemm,bottom=20truemm]{geometry}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{setspace}
\usepackage{wrapfig}
\usepackage{mathcomp}
\DeclareMathOperator\arctanh{arctanh}
\DeclareMathOperator\arccosh{arccosh}
\title{blackhole-simulator documents}
\author{https://github.com/hypernumbernet}
\date{\today}
\begin{document}
\maketitle

\begin{abstract}
重力多体シミュレーションを行うに当たって数学的基盤を整えておく目的でまとめを書いています。
プログラミングですぐに活用できるように計算手順を具体化し実係数で式を展開しています。
\end{abstract}

\chapter{双四元数による特殊相対性理論}

\section{双四元数とは}

まず、複素数は以下のように定義されることを復習しましょう。
\begin{equation}
\texttt{Complex number}:\mathbb{C}\coloneq ~r_0+r_1i,\quad r_0,r_1\in\mathbb{R},\quad i^2=-1
\end{equation}

四元数は以下のようになります。クォータニオンとも呼びます。
\begin{equation}
\begin{split}
\texttt{Quaternion}:\mathbb{H}\coloneq ~&r_0+r_1i+r_2j+r_3k,\quad r_0,r_1,r_2,r_3\in\mathbb{R}\\
&i^2=j^2=k^2=-1
\end{split}
\end{equation}

四元数の演算規則です。
\begin{gather}
ij=k,~jk=i,~ki=j,~ji=-k,~kj=-i,~ik=-j
\end{gather}

双四元数とは四元数の4つの係数を複素数にしたもので、8つの実数を内包します。バイクォータニオンとも呼びます。
\begin{equation}
\begin{split}
\texttt{Biquaternion}:\mathbb{B}\coloneq ~&w_0+w_1i+w_2j+w_3k,\quad w_0,w_1,w_2,w_3\in\mathbb{C}\\
=~&r_0+r_1I+(r_2+r_3I)i+(r_4+r_5I)j+(r_6+r_7I)k\\
&r_0,...,r_7\in\mathbb{R},\quad I^2=-1
\end{split}
\end{equation}

新たに導入した虚数$I$と四元数部分の虚数$i, j, k$は互いに干渉しません。
\begin{equation}
iI=Ii,~jI=Ij,~kI=Ik
\end{equation}

\section{双四元数の共役は2種類}

複素数の共役と絶対値は以下のようでした。
\begin{equation}
\begin{split}
w=~&r_0+r_1i,\quad w\in\mathbb{C}\\
\overline{w}=~&r_0-r_1i\\
|w|=~&\sqrt{w\overline{w}}=\sqrt{r_0^2+r_1^2}
\end{split}
\end{equation}

四元数での共役とノルムです。ここでは*を使って表現します。ノルムは絶対値の2乗とします。
\begin{equation}
\begin{split}
h=~&r_0+r_1i+r_2j+r_3k,\quad h\in\mathbb{H}\\
h^*=~&r_0-r_1i-r_2j-r_3k\\
N(h)=~&hh^*=r_0^2+r_1^2+r_2^2+r_3^2\\
|h|=~&\sqrt{N(h)}=\sqrt{r_0^2+r_1^2+r_2^2+r_3^2}
\end{split}
\end{equation}

双四元数では共役は以下のように2種類が定義されます。
\begin{equation}
\begin{split}
b=~&w_0+w_1i+w_2j+w_3k,\quad w_0,w_1,w_2,w_3\in\mathbb{C},\quad b\in\mathbb{B}\\
=~&r_0+r_1I+(r_2+r_3I)i+(r_4+r_5I)j+(r_6+r_7I)k,\quad r_0,...,r_7\in\mathbb{R}\\
b^*=~&w_0-w_1i-w_2j-w_3k\\
=~&r_0+r_1I-(r_2+r_3I)i-(r_4+r_5I)j-(r_6+r_7I)k\\
\overline{b}=~&\overline{w_0}+\overline{w_1}i+\overline{w_2}j+\overline{w_3}k\\
=~&r_0-r_1I+(r_2-r_3I)i+(r_4-r_5I)j+(r_6-r_7I)k
\end{split}
\end{equation}

双四元数のノルムの定義は四元数としての共役の定義を使用して定義します。
\begin{equation}
N(b)=bb^*=w_0^2+w_1^2+w_2^2+w_3^2
\end{equation}

\section{双四元数で表現する特殊相対論的時空}

双四元数の一部を使って相対論の4次元時空を表現できます。
\begin{equation}
\begin{split}
\texttt{Spacetime}:\mathbb{M}\coloneq &\{m:m^*=\overline{m}\}\\
=&\{t+xIi+yIj+zIk,\quad t,x,y,z\in\mathbb{R}\}
\end{split}
\end{equation}

ノルムが丁度不変量になります。
\begin{equation}
\texttt{Invariant}:mm^*=t^2-x^2-y^2-z^2,\quad m\in\mathbb{M}
\end{equation}
このような集合をミンコフスキー空間とも呼びます。

以下のような双四元数の集合を定義します。ノルムが1になるという意味で単位双四元数と呼びます。
\begin{equation}
\mathbb{G}\coloneq\{g:gg^*=1,\quad g\in\mathbb{B}\}
\end{equation}

するとローレンツ変換は以下の計算で成立します。
\begin{equation}
\texttt{Lorentz transformation}:T(m)=g^*m\overline{g},\quad m\in\mathbb{M}
\end{equation}

変換後の値も時空を表しています。
\begin{equation}
T(m)\in\mathbb{M}
\end{equation}

変換後も不変量は変化しません。
\footnote{簡潔な証明が可能です。WikipediaのBiquaternionを参照してください。}
\begin{equation}
T(m)(T(m))^*=mm^*
\end{equation}

\section{単位双四元数が広げる可能性}

以上のように、時空の不変量を変化させないように時空を変換する道具として双四元数が使えます。
光速度不変の原理を壊すことなくローレンツ変換を行う双四元数の条件を得ています。
任意の単位双四元数です。
4つの実数からなる時空$\mathbb{M}$を8つの実数からなる単位双四元数$\mathbb{G}$で変換する事になるので、
4次元を超越した次元へのアクセスが出来るのではないかと期待できます。
もしかしたら、4次元時空を破綻させないまま超空間へ転移する挙動を表現できるかもしれません。

\section{特殊相対論的速度との関係}

単位双四元数の集合全体について一般的に位相群を解明する事は困難です。
しかし、その一部である$\mathbb{G}\cap\mathbb{M}$については以下のように計算できることが分かっています。

三次元空間の方向を表現する単位四元数の集合を定義します。ノルムが1の純虚四元数となっており、ベルソルとも呼びます。
\begin{equation}
\begin{split}
\texttt{Versor}:\mathbb{V}\coloneq&\{d:d=\sqrt{-1},\quad d\in\mathbb{H}\}\\
=&\{d_1i+d_2j+d_3k,\quad d_1,d_2,d_3\in\mathbb{R},\quad d_1^2+d_2^2+d_3^2=1\}
\end{split}
\end{equation}

以下のように計算すると、$Id$が分解型複素数(Split-complex number)を表現している事が分かります。
\begin{equation}
(Id)^2=I^2d^2=(-1)(-1)=+1
\end{equation}

分解型複素数のオイラーの公式を調べてみます。
\begin{equation}
\begin{split}
\exp(aId)=&\cosh a+Id\sinh a,\quad a\in\mathbb{R}\\
&\cosh a+(d_1Ii+d_2Ij+d_3Ik)\sinh a
\end{split}
\end{equation}

この至宝の公式は四次元時空の集合の範囲内にあることがわかります。
\begin{equation}
\exp(aId)\in\mathbb{M}
\end{equation}

四次元時空の双曲幾何学的な性質からこの公式内での速さは丁度以下のようになります。
\begin{equation}
\texttt{Speed}:v=c\tanh a,\quad c:\texttt{Speed of light},\quad v\in\mathbb{R}
\end{equation}

速さから逆に角度を求めると以下のようになります。この角度はラピディティという名前があります。
\begin{equation}
\texttt{Rapidity}:a=\arctanh\frac{|\bm{v}|}{c}
\end{equation}

ラピディティには単純な足し算が出来るというメリットがあります。

\section{双四元数によるローレンツ変換の計算方法}

四元数による回転計算からの類推で双四元数によるローレンツ変換の角度も半角化すれば丁度良いことがわかります。
\begin{equation}
g=\exp(0.5aId) \to g^*=\overline{g}=\exp(-0.5aId)
\end{equation}

と置けば、
\begin{equation}
\begin{split}
T(\exp(aId))=&g^*\exp(aId)\overline{g}\\
=&\exp(-0.5aId)\exp(aId)\exp(-0.5aId)\\
=&\exp(-0.5aId+aId-0.5aId)\\
=&1
\end{split}
\end{equation}

この変換を双四元数の実数成分で表現してみると、
\begin{equation}
g=\exp(0.5aId)=r_0+r_1Ii+r_2Ij+r_3Ik
\end{equation}

と置いて、
\begin{equation}
r_0=\cosh 0.5a,\quad (r_1,r_2,r_3)=(d_1,d_2,d_3)\sinh 0.5a,\quad d_1^2+d_2^2+d_3^2=1
\end{equation}

となります。変換に使用する単位双四元数を得ました。変換元の四次元時空を
\begin{equation}
m=t+xIi+yIj+zIk
\end{equation}

と置くと、
\begin{equation}
\begin{split}
T(m)=~&g^*m\overline{g}\\
=~&(r_0-r_1Ii-r_2Ij-r_3Ik)(t+xIi+yIj+zIk)(r_0-r_1Ii-r_2Ij-r_3Ik)\\
=~&(r_0t-r_1tIi-r_2tIj-r_3tIk+r_0xIi-r_1xIiIi-r_2xIjIi-r_3xIkIi+r_0yIj-r_1yIiIj-r_2yIjIj-r_3yIkIj\\
&+r_0zIk-r_1zIiIk-r_2zIjIk-r_3zIkIk)(r_0-r_1Ii-r_2Ij-r_3Ik)\\
=~&(r_0t-r_1tIi-r_2tIj-r_3tIk+r_0xIi-r_1x-r_2xk+r_3xj+r_0yIj+r_1yk-r_2y-r_3yi\\
&+r_0zIk+r_1zj+r_2zi-r_3z)(r_0-r_1Ii-r_2Ij-r_3Ik)\\
=~&(r_0t-r_1x-r_2y-r_3z+(r_2z-r_3y)i+(r_1z+r_3x)j+(r_1y-r_2x)k\\
&+(r_0x-r_1t)Ii+(r_0y-r_2t)Ij+(r_0z-r_3t)Ik)(r_0-r_1Ii-r_2Ij-r_3Ik)\\
\end{split}
\end{equation}

\begin{equation}
\begin{split}
=~&r_0^2t-r_0r_1x-r_0r_2y-r_0r_3z+r_0(r_2z-r_3y)i+r_0(r_1z+r_3x)j+r_0(r_1y-r_2x)k\\
&+r_0(r_0x-r_1t)Ii+r_0(r_0y-r_2t)Ij+r_0(r_0z-r_3t)Ik\\
&+(-r_0r_1t+r_1^2x+r_1r_2y+r_1r_3z)Ii+r_1(r_2z-r_3y)I+r_1(r_1z+r_3x)Ik-r_1(r_1y-r_2x)Ij\\
&-r_1(r_0x-r_1t)-r_1(r_0y-r_2t)k+r_1(r_0z-r_3t)j\\
&+(-r_0r_2t+r_1r_2x+r_2^2y+r_2r_3z)Ij-r_2(r_2z-r_3y)Ik+r_2(r_1z+r_3x)I+r_2(r_1y-r_2x)Ii\\
&+r_2(r_0x-r_1t)k-r_2(r_0y-r_2t)-r_2(r_0z-r_3t)i\\
&+(-r_0r_3t+r_1r_3x+r_2r_3y+r_3^2z)Ik+r_3(r_2z-r_3y)Ij-r_3(r_1z+r_3x)Ii+r_3(r_1y-r_2x)I\\
&-r_3(r_0x-r_1t)j+r_3(r_0y-r_2t)i-r_3(r_0z-r_3t)\\
=~&r_0^2t-r_0r_1x-r_0r_2y-r_0r_3z-r_1(r_0x-r_1t)-r_2(r_0y-r_2t)-r_3(r_0z-r_3t)\\
&+r_0(r_2z-r_3y)i-r_2(r_0z-r_3t)i+r_3(r_0y-r_2t)i\\
&+r_0(r_1z+r_3x)j+r_1(r_0z-r_3t)j-r_3(r_0x-r_1t)j\\
&+r_0(r_1y-r_2x)k-r_1(r_0y-r_2t)k+r_2(r_0x-r_1t)k\\
&+r_1(r_2z-r_3y)I+r_2(r_1z+r_3x)I+r_3(r_1y-r_2x)I\\
&+r_0(r_0x-r_1t)Ii+(-r_0r_1t+r_1^2x+r_1r_2y+r_1r_3z)Ii+r_2(r_1y-r_2x)Ii-r_3(r_1z+r_3x)Ii\\
&+r_0(r_0y-r_2t)Ij-r_1(r_1y-r_2x)Ij+(-r_0r_2t+r_1r_2x+r_2^2y+r_2r_3z)Ij+r_3(r_2z-r_3y)Ij\\
&+r_0(r_0z-r_3t)Ik+r_1(r_1z+r_3x)Ik-r_2(r_2z-r_3y)Ik+(-r_0r_3t+r_1r_3x+r_2r_3y+r_3^2z)Ik\\
\end{split}
\end{equation}

$i,j,k,I$の項はきれいに消えます。
\begin{equation}
\begin{split}
T(m)=~&(r_0^2+r_1^2+r_2^2+r_3^2)t-2r_0(r_1x+r_2y+r_3z)\\
&+((r_0^2+r_1^2-r_2^2-r_3^2)x-2r_1(r_0t-r_2y-r_3z))Ii\\
&+((r_0^2-r_1^2+r_2^2-r_3^2)y-2r_2(r_0t-r_1x-r_3z))Ij\\
&+((r_0^2-r_1^2-r_2^2+r_3^2)z-2r_3(r_0t-r_1x-r_2y))Ik
\end{split}
\end{equation}

従って、四次元時空各成分に注目したローレンツ変換は以下となります。
\begin{equation}
\begin{split}
t'=~&(r_0^2+r_1^2+r_2^2+r_3^2)t-2r_0(r_1x+r_2y+r_3z)\\
x'=~&(r_0^2+r_1^2-r_2^2-r_3^2)x-2r_1(r_0t-r_2y-r_3z)\\
y'=~&(r_0^2-r_1^2+r_2^2-r_3^2)y-2r_2(r_0t-r_1x-r_3z)\\
z'=~&(r_0^2-r_1^2-r_2^2+r_3^2)z-2r_3(r_0t-r_1x-r_2y)
\end{split}
\end{equation}
コンピューターによる計算にとってはこの最適化が有用になるでしょう。

\section{ラピディティによるもう一つの計算方法}

ラピディティの足し算による計算方法もあります。以下のように変換対象の時空を定義します。
\begin{equation}
\begin{split}
mv=~&\exp(qIp),\quad p=p_1i+p_2j+p_3k\\
t=~&\cosh q,\quad (x,y,z)=(p_1,p_2,p_3)\sinh q\\
&m\in\mathbb{M},\quad q,p_1,p_2,p_3\in\mathbb{R},\quad p\in\mathbb{D}
\end{split}
\end{equation}

$t,x,y,z$から$q,p_1,p_2,p_3$を算出する必要があり、方法はいくつか考えられますが、一つとしては以下のようになります。
\begin{equation}
q=\arccosh t,\quad (p_1,p_2,p_3)=\frac{(x,y,z)}{\sqrt{x^2+y^2+z^2}}
\end{equation}

この変換では原点座標ではゼロの除算になるので特別な配慮が必要です。

ここまで準備できればローレンツ変換は単純に加法減法になります。

変換した分の速度をラピディティ$a\in\mathbb{R}$方向$d\in\mathbb{D}$として、
\begin{equation}
\begin{split}
T(m)=~&g^*m\overline{g}\\
=~&\exp(-0.5aId)\exp(qIp)\exp(-0.5aId)\\
=~&\exp((qp-ad)I)
\end{split}
\end{equation}

全ての計算をラピディティで完結させることが出来ればこれ程単純な計算方法はないです。
しかし、実際は現実世界の座標に以下のように変換する必要があります。
\begin{equation}
q'p'=qp-ad,\quad q'\in\mathbb{R},\quad p'\in\mathbb{D},\quad p'=p'_1i+p'_2j+p'_3k
\end{equation}

\begin{equation}
q'=|qp-ad|,\quad p'=\frac{qp-ad}{|qp-ad|}
\end{equation}

\begin{equation}
t'=\cosh q',\quad (x',y',z')=(p'_1,p'_2,p'_3)\sinh q'\\
\end{equation}

\section{行列を使ったローレンツ変換}

比較のために行列を使った算出方法を掲載しておきます。
\begin{equation}
\bm{v}=(v_1,v_2,v_3),\quad v_1,v_2,v_3\in\mathbb{R}
\end{equation}

\begin{equation}
\beta=\frac{|\bm{v}|}{c},\quad \gamma=\frac{1}{\sqrt{1-\beta^2}}
\end{equation}

\begin{equation}
\setstretch{2.7}
\begin{bmatrix}
ct'\\x'\\y'\\z'
\end{bmatrix}
=
\setstretch{1.6}
\begin{bmatrix}
\gamma & -\cfrac{v_1}{c}\gamma & -\cfrac{v_2}{c}\gamma & -\cfrac{v_3}{c}\gamma \\[3pt]
-\cfrac{v_1}{c}\gamma & 1+\cfrac{v_1^2}{|\bm{v}|}(\gamma-1) & \cfrac{v_1v_2}{|\bm{v}|}(\gamma-1) & \cfrac{v_1v_3}{|\bm{v}|}(\gamma-1)\\
-\cfrac{v_2}{c}\gamma & \cfrac{v_1v_2}{|\bm{v}|}(\gamma-1) & 1+\cfrac{v_2^2}{|\bm{v}|}(\gamma-1) & \cfrac{v_2v_3}{|\bm{v}|}(\gamma-1)\\
-\cfrac{v_3}{c}\gamma & \cfrac{v_1v_3}{|\bm{v}|}(\gamma-1) & \cfrac{v_2v_3}{|\bm{v}|}(\gamma-1) & 1+\cfrac{v_3^2}{|\bm{v}|}(\gamma-1)
\end{bmatrix}
\setstretch{2.7}
\begin{bmatrix}
ct\\x\\y\\z
\end{bmatrix}
\end{equation}

\section{単位双四元数は高次元の回転}

任意の双四元数$b_0,b_1$の積をその実数成分で表現しておきます。
\begin{equation}
\begin{split}
b_0=~&p_0+p_1I+(p_2+p_3I)i+(p_4+p_5I)j+(p_6+p_7I)k,\quad p_0,...,p_7\in\mathbb{R}\\
=~&w_0+w_1i+w_2j+w_3k,\quad w_0,w_1,w_2,w_3\in\mathbb{H}\\
b_1=~&q_0+q_1I+(q_2+q_3I)i+(q_4+q_5I)j+(q_6+q_7I)k,\quad p_0,...,p_7\in\mathbb{R}\\
=~&u_0+u_1i+u_2j+u_3k,\quad u_0,u_1,u_2,u_3\in\mathbb{H}
\end{split}
\end{equation}

まずは、通常の四元数の乗算を行います。
\begin{equation}
\begin{split}
b_0b_1=~&(w_0+w_1i+w_2j+w_3k)(u_0+u_1i+u_2j+u_3k)\\
=~&w_0u_0+w_0u_1i+w_0u_2j+w_0u_3k\\
&+w_1iu_0+w_1iu_1i+w_1iu_2j+w_1iu_3k\\
&+w_2ju_0+w_2ju_1i+w_2ju_2j+w_2ju_3k\\
&+w_3ku_0+w_3ku_1i+w_3ku_2j+w_3ku_3k\\
=~&w_0u_0+w_0u_1i+w_0u_2j+w_0u_3k\\
&+w_1u_0i-w_1u_1+w_1u_2k-w_1u_3j\\
&+w_2u_0j-w_2u_1k-w_2u_2+w_2u_3i\\
&+w_3u_0k+w_3u_1j-w_3u_2i-w_3u_3\\
=~&w_0u_0-w_1u_1-w_2u_2-w_3u_3\\
&+(w_0u_1+w_1u_0+w_2u_3-w_3u_2)i\\
&+(w_0u_2-w_1u_3+w_2u_0+w_3u_1)j\\
&+(w_0u_3+w_1u_2-w_2u_1+w_3u_0)k
\end{split}
\end{equation}

次に実数に展開します。
\begin{equation}
\begin{split}
b_0b_1=~&(p_0+p_1I)(q_0+q_1I)-(p_2+p_3I)(q_2+q_3I)-(p_4+p_5I)(q_4+q_5I)-(p_6+p_7I)(q_6+q_7I)\\
&+((p_0+p_1I)(q_2+q_3I)+(p_2+p_3I)(q_0+q_1I)+(p_4+p_5I)(q_6+q_7I)-(p_6+p_7I)(q_4+q_5I))i\\
&+((p_0+p_1I)(q_4+q_5I)-(p_2+p_3I)(q_6+q_7I)+(p_4+p_5I)(q_0+q_1I)+(p_6+p_7I)(q_2+q_3I))j\\
&+((p_0+p_1I)(q_6+q_7I)+(p_2+p_3I)(q_4+q_5I)-(p_4+p_5I)(q_2+q_3I)+(p_6+p_7I)(q_0+q_1I))k
\end{split}
\end{equation}
\begin{equation}
\begin{split}
=~&(p_0q_0-p_1q_1+(p_0q_1+p_1q_0)I)-(p_2q_2-p_3q_3+(p_2q_3+p_3q_2)I)\\
&-(p_4q_4-p_5q_5+(p_4q_5+p_5q_4)I)-(p_6q_6-p_7q_7+(p_6q_7+p_7q_6)I)\\
&+((p_0q_2-p_1q_3+(p_0q_3+p_1q_2)I)+(p_2q_0-p_3q_1+(p_2q_1+p_3q_0)I)\\
&+(p_4q_6-p_5q_7+(p_4q_7+p_5q_6)I)-(p_6q_4-p_7q_5+(p_6q_5+p_7q_4)I))i\\
&+((p_0q_4-p_1q_5+(p_0q_5+p_1q_4)I)-(p_2q_6-p_3q_7+(p_2q_7+p_3q_6)I)\\
&+(p_4q_0-p_5q_1+(p_4q_1+p_5q_0)I)+(p_6q_2-p_7q_3+(p_6q_3+p_7q_2)I))j\\
&+((p_0q_6-p_1q_7+(p_0q_7+p_1q_6)I)+(p_2q_4-p_3q_5+(p_2q_5+p_3q_4)I)\\
&-(p_4q_2-p_5q_3+(p_4q_3+p_5q_2)I)+(p_6q_0-p_7q_1+(p_6q_1+p_7q_0)I))k
\end{split}
\end{equation}
\begin{equation}
\begin{split}
=~&p_0q_0-p_1q_1-p_2q_2+p_3q_3-p_4q_4+p_5q_5-p_6q_6+p_7q_7\\
&+(p_0q_1+p_1q_0-p_2q_3-p_3q_2-p_4q_5-p_5q_4-p_6q_7-p_7q_6)I\\
&+(p_0q_2-p_1q_3+p_2q_0-p_3q_1+p_4q_6-p_5q_7-p_6q_4+p_7q_5)i\\
&+(p_0q_3+p_1q_2+p_2q_1+p_3q_0+p_4q_7+p_5q_6-p_6q_5-p_7q_4)Ii\\
&+(p_0q_4-p_1q_5-p_2q_6+p_3q_7+p_4q_0-p_5q_1+p_6q_2-p_7q_3)j\\
&+(p_0q_5+p_1q_4-p_2q_7-p_3q_6+p_4q_1+p_5q_0+p_6q_3+p_7q_2)Ij\\
&+(p_0q_6-p_1q_7+p_2q_4-p_3q_5-p_4q_2+p_5q_3+p_6q_0-p_7q_1)k\\
&+(p_0q_7+p_1q_6+p_2q_5+p_3q_4-p_4q_3-p_5q_2+p_6q_1+p_7q_0)Ik
\end{split}
\end{equation}

双四元数のノルムを実数成分で表しておくと以下のようになります。
\begin{equation}
g=a_0+a_1I+(a_2+a_3I)i+(a_4+a_5I)j+(a_6+a_7I)k,\quad a_0,..., a_7\in\mathbb{R}
\end{equation}

\begin{equation}
\begin{split}
gg^*=~&(a_0+a_1I)^2+(a_2+a_3I)^2+(a_4+a_5I)^2+(a_6+a_7I)^2\\
=~&a_0^2-a_1^2+a_2^2-a_3^2+a_4^2-a_5^2+a_6^2-a_7^2+2(a_0a_1+a_2a_3+a_4a_5+a_6a_7)I
\end{split}
\end{equation}

参考までに
\begin{equation}
gg^*=1\iff
\begin{cases}
a_0^2-a_1^2+a_2^2-a_3^2+a_4^2-a_5^2+a_6^2-a_7^2=1\\
a_0a_1+a_2a_3+a_4a_5+a_6a_7=0
\end{cases}
\end{equation}

双四元数のノルムは双四元数の積に対して乗法的である事が示せます。
つまり、任意の双四元数$(b_0,b_1)$に対して次の式が成り立ちます。
\begin{equation}
N(b_0b_1)=N(b_0)N(b_1)
\end{equation}

幸いな事に実数に展開しなくても証明できます。
\begin{equation}
N(b_0b_1)=(b_0b_1)(b_0b_1)^*=b_0b_1b_1^*b_0^*=b_0N(b_1)b_0^*=N(b_1)b_0b_0^*=N(b_1)N(b_0)=N(b_0)N(b_1)
\end{equation}

$b_0$と$b_1$のノルムがどちらも$1$の場合、
\begin{equation}
b_0,b_1\in\mathbb{G}\iff N(b_0)=N(b_1)=1\iff N(b_0b_1)=1
\end{equation}
従って、単位双四元数の乗算は回転を意味しています。双曲的な高次元の角度となっています。

特殊相対性理論のローレンツ変換は光速を1とした場合、三次元の角度と捉える事ができます。
それを回転させる単位双四元数についても角度でありますから、
ここまでの所は物理的有意性のある計量として角度のみでの記述が可能という事になります。

\chapter{多元数による回転計算}

\section{複素数による回転計算}

オイラーの公式により角度と絶対値が1の複素数の関係が明らかになっています。
\begin{equation}
\exp(aI)=\cos a+I\sin a,\quad a\in\mathbb{R},\quad I^2=-1
\end{equation}
\begin{equation}
|\exp(aI)|=\sqrt{\cos^2 a+\sin^2 a}=1
\end{equation}
ここでは複素数の虚数単位をあえて$I$で表現しています。

任意の二次元座標$(x,y)$を原点回りに角度$a$回転させる計算は、$x+yI,\quad x,y\in\mathbb{R}$を構築して、
\begin{equation}
x'+y'I=(x+yI)\exp(aI)
\end{equation}
で算出できます。

\section{四元数による三次元の回転計算}

任意の三次元座標を原点回りに回転させる計算は二次元ほど単純ではありません。
二次元での回転と違いどの方向に回転させるかのパラメーターも必要になります。
行列を使って三次元の回転の計算をすることは一応できますが、
ジンバルロックの問題を回避して完全な回転計算を行うには四元数を使う計算が必須になります。

身近な例で言うと、天と地の軸が定まっている3Dゲームでは四元数は必須ではないですが、
宙返りを自由に行うフライトシミュレーターでは四元数は必須になってきます。
ゲームエンジンのライブラリに含まれるQuaternionクラスには四元数による回転計算が完全に実装されていない例があるようです。
その場合、以下の計算方法を独自に実装する必要があります。

方向を表す三次元単位ベクトル$\bm{a},\bm{b}$があり、$\bm{a}$から$\bm{b}$の方向に$t\in\mathbb{R}$の割合だけ回転させる計算は以下のようになります。
この計算方法は球面線形補間(Slerp)と呼ばれます。

$\bm{a}$と$\bm{b}$の成す角度$\theta$を内積から求めます。
\begin{equation}
\begin{split}
\bm{a}=~&(a_x,a_y,a_z),\quad \bm{b}=~(b_x,b_y,b_z),\quad a_x,a_y,a_z,b_x,b_y,b_z\in\mathbb{R}\\
\theta=~&\arccos(\bm{a}\cdot\bm{b})=\arccos(a_xb_x+a_yb_y+a_zb_z),\quad \theta\in\mathbb{R}
\end{split}
\end{equation}

回転軸\footnote{一般的に$N$次元の回転軸は$N-1$次元になります。プログラム中の名称はaxis。}を表す三次元単位ベクトルを外積から求めます。
\begin{equation}
\bm{w}_{cross}=~\bm{a}\times\bm{b}=a_yb_z-a_zb_y,~a_zb_x-a_xb_z,~a_xb_y-a_yb_x
\end{equation}

この外積の結果を正規化し単位ベクトルにしておきます。
\begin{equation}
\bm{w}_{unit}=\frac{\bm{w}_{cross}}{|\bm{w}_{cross}|}
\end{equation}
ここの計算では$\bm{a}$と$\bm{b}$が一致する場合と正反対を向く場合については特別な配慮が必要です。

この回転軸をベルソル化しておきます。
\begin{equation}
w=\bm{w}_{unit}\begin{pmatrix}i\\j\\k\end{pmatrix}=w_xi+w_yj+w_zk,\quad w\in\mathbb{V}
\end{equation}

回転子\footnote{プログラム中の名称はrotator。}としての四元数は以下のように構成されます。
\footnote{$h$のノルムは$1$になっていますので、$h$は単位四元数です。}
\begin{equation}
h=\exp(-0.5t\theta w)=\cos 0.5t\theta-w\sin 0.5t\theta,\quad h\in\mathbb{H}
\end{equation}

回転させたい三次元座標$(x,y,z)$を純虚四元数化させておきます。
\footnote{純虚四元数とは実数部分がゼロになっている四元数の事で四元数のベクトルパートとも呼ばれます。}
\begin{equation}
f=xi+yj+zk
\end{equation}

回転後の三次元座標$(x',y',z')$は、
\begin{equation}
x'i+y'j+z'k=h^*fh
\end{equation}
という計算で算出できます。
右側を共役として説明される場合もありますが、どちらでも回転計算はできます。

コンピューターでの計算速度を考えると実数成分に展開して最適化しておいた方が良さそうです。

$h=r_0+r_1i+r_2j+r_3k$と置いて、
\begin{equation}
\begin{split}
h^*fh=~&(r_0-r_1i-r_2j-r_3k)(xi+yj+zk)(r_0+r_1i+r_2j+r_3k)\\
=~&(r_0xi+r_0yj+r_0zk+r_1x-r_1yk+r_1zj+r_2xk+r_2y-r_2zi-r_3xj+r_3yi+r_3z)\\
&(r_0+r_1i+r_2j+r_3k)\\
=~&(r_1x+r_2y+r_3z+(r_0x-r_2z+r_3y)i+(r_0y-r_3x+r_1z)j+(r_0z-r_1y+r_2x)k)\\
&(r_0+r_1i+r_2j+r_3k)\\
=~&(r_1x+r_2y+r_3z)r_0+(r_1x+r_2y+r_3z)r_1i+(r_1x+r_2y+r_3z)r_2j+(r_1x+r_2y+r_3z)r_3k\\
&+(r_0x-r_2z+r_3y)r_0i-(r_0x-r_2z+r_3y)r_1+(r_0x-r_2z+r_3y)r_2k-(r_0x-r_2z+r_3y)r_3j\\
&+(r_0y-r_3x+r_1z)r_0j-(r_0y-r_3x+r_1z)r_1k-(r_0y-r_3x+r_1z)r_2+(r_0y-r_3x+r_1z)r_3i\\
&+(r_0z-r_1y+r_2x)r_0k+(r_0z-r_1y+r_2x)r_1j-(r_0z-r_1y+r_2x)r_2i-(r_0z-r_1y+r_2x)r_3\\
=~&r_0r_1x+r_0r_2y+r_0r_3z-r_0r_1x-r_1r_2z+r_1r_3y-r_0r_2y-r_2r_3x+r_1r_2z-r_0r_3z-r_1r_3y+r_2r_3x\\
&+(r_1^2x+r_1r_2y+r_1r_3z)i+(r_0^2x-r_0r_2z+r_0r_3y)i+(r_0r_3y-r_3^2x+r_1r_3z)i-(r_0r_2z-r_1r_2y+r_2^2x)i\\
&+(r_1r_2x+r_2^2y+r_2r_3z)j-(r_0r_3x-r_2r_3z+r_3^2y)j+(r_0^2y-r_0r_3x+r_0r_1z)j+(r_0r_1z-r_1^2y+r_1r_2x)j\\
&+(r_1r_3x+r_2r_3y+r_3^2z)k+(r_0r_2x-r_2^2z+r_2r_3y)k-(r_0r_1y-r_1r_3x+r_1^2z)k+(r_0^2z-r_0r_1y+r_0r_2x)k
\end{split}
\end{equation}
ここでスカラーパートはきれいに消えます。
\footnote{四元数の実数部分をスカラーパートと呼びます。}
\begin{equation}
\begin{split}
h^*fh=~&(r_1^2x+r_1r_2y+r_1r_3z+r_0^2x-r_0r_2z+r_0r_3y+r_0r_3y-r_3^2x+r_1r_3z-r_0r_2z+r_1r_2y-r_2^2x)i\\
&+(r_1r_2x+r_2^2y+r_2r_3z-r_0r_3x+r_2r_3z-r_3^2y+r_0^2y-r_0r_3x+r_0r_1z+r_0r_1z-r_1^2y+r_1r_2x)j\\
&+(r_1r_3x+r_2r_3y+r_3^2z+r_0r_2x-r_2^2z+r_2r_3y-r_0r_1y+r_1r_3x-r_1^2z+r_0^2z-r_0r_1y+r_0r_2x)k\\
=~&(r_1^2x+r_0^2x-r_3^2x-r_2^2x+r_1r_2y+r_0r_3y+r_0r_3y+r_1r_2y+r_1r_3z-r_0r_2z+r_1r_3z-r_0r_2z)i\\
&+(r_1r_2x-r_0r_3x-r_0r_3x+r_1r_2x+r_2^2y-r_3^2y+r_0^2y-r_1^2y+r_2r_3z+r_2r_3z+r_0r_1z+r_0r_1z)j\\
&+(r_1r_3x+r_0r_2x+r_1r_3x+r_0r_2x+r_2r_3y+r_2r_3y-r_0r_1y-r_0r_1y+r_3^2z-r_2^2z-r_1^2z+r_0^2z)k\\
=~&((r_0^2+r_1^2-r_2^2-r_3^2)x+2((r_1r_2+r_0r_3)y+(r_1r_3-r_0r_2)z))i\\
&+((r_0^2-r_1^2+r_2^2-r_3^2)y+2((r_1r_2-r_0r_3)x+(r_2r_3+r_0r_1)z))j\\
&+((r_0^2-r_1^2-r_2^2+r_3^2)z+2((r_1r_3+r_0r_2)x+(r_2r_3-r_0r_1)y))k
\end{split}
\end{equation}

最終的に、三次元座標の単位四元数による回転は以下の式になります。
\begin{equation}
\begin{split}
x'=~&(r_0^2+r_1^2-r_2^2-r_3^2)x+2((r_1r_2+r_0r_3)y+(r_1r_3-r_0r_2)z)\\
y'=~&(r_0^2-r_1^2+r_2^2-r_3^2)y+2((r_1r_2-r_0r_3)x+(r_2r_3+r_0r_1)z)\\
z'=~&(r_0^2-r_1^2-r_2^2+r_3^2)z+2((r_1r_3+r_0r_2)x+(r_2r_3-r_0r_1)y)
\end{split}
\end{equation}
CGのコンピューティングではあらかじめこの計算をしておき四次元行列に組み込む事になるでしょう。

\section{超球の形をする宇宙}

三次元での回転については球の表面で描くことができるので想像しやすいです。
例えば地球の表面については経度と緯度の二次元で表現できます。
同様に、四次元単位ベクトルの回転についても三次元で表現できます。
三次元超球面(3-sphere)
\footnote{ここで言う三次元超球面は球の中心が原点にあり半径1の超球の事です。}
という言葉を使います。グロームとも呼ばれています。
グロームは宇宙空間そのものであると考えられており、一般相対性理論をグロームに適用すると
時間と共に宇宙が拡大しているという結論が導き出されるのでよく議論の対象になります。
グロームは四次元単位ベクトルに相当します。
従って、四次元単位ベクトルの回転計算とは宇宙空間における移動そのものと考える事ができます。
さらに、四次元単位ベクトルは単位四元数に相当するので、単位四元数の回転が宇宙空間の移動であるとする事もできます。

整理すると、三次元超球面(3-sphere)=グローム(glome)=四次元単位ベクトル=単位四元数=宇宙空間となります。
\begin{equation}
\begin{split}
\texttt{3-sphere}:\mathbb{S}\coloneq&\{s:ss^*=1,\quad s\in\mathbb{H}\}\\
=~&\{\exp(ae)=\cos a+e\sin a,\quad a\in\mathbb{R},\quad e\in\mathbb{V}\}
\end{split}
\end{equation}

地球上での移動が実は平面的でなく球の上を曲がって移動しているように、
宇宙空間での移動も四次元内の超球面を曲がって移動していると考えられます。
宇宙が巨大なのでそれを観測することが難しいのです。
このビジョンでは宇宙の果てには壁はなく逆方向から元の位置に戻ってくる事になります。
地上での移動の本質が経度と緯度の角度であると同様に宇宙空間での移動も本質は角度である事に注目してください。

\section{単位四元数の視覚化}

四次元の回転を視覚化して直感的に把握するようにしたい所です。
単位四元数の指数関数によって三次元空間に三次元超球面をプロットする事ができます。

以下の計算で単位四元数を三次元化できます。
\begin{equation}
\begin{split}
&s=s_0+s_1i+s_2j+s_3k,\quad s\in\mathbb{S}\mapsto (x,y,z)\\
&v=s_1i+s_2j+s_3k\\
&xi+yj+zk=\frac{v}{|v|}\arccos s_0
\end{split}
\end{equation}

ただし、コンピューターでの計算では誤差や値域の関係から、\texttt{atan2}()を使った方が良いです。
\begin{gather}
xi+yj+zk=\frac{v}{|v|}\texttt{atan2}(|v|, s_0)
\end{gather}

また、四元数の指数関数について以下のように変形しておくとイメージしやすいです。
普通に四元数$h=a+bi+cj+dk$の指数関数を求めると、
\begin{gather}
\exp(h)=\exp(a)\left(\cos\sqrt{b^2+c^2+d^2}+\frac{bi+cj+dk}{\sqrt{b^2+c^2+d^2}}\sin\sqrt{b^2+c^2+d^2}\right)
\end{gather}

という形になりますが、予め$\theta=\sqrt{b^2+c^2+d^2}$と置いて整理しておくと、
\begin{gather}
h=a+bi+cj+dk=a+\theta v,\quad v\in\mathbb{V}\\
\exp(h)=\exp(a+\theta v)=\exp(a)(\cos \theta+v\sin\theta)
\end{gather}
というように簡潔になります。特に純虚四元数ではさらに簡潔になります。
\begin{gather}
\exp(\theta v)=\cos \theta+v\sin\theta
\end{gather}
三次元の方向が$v$で移動量が$\theta$というイメージで把握できるようになります。

また、以下のように計算すれば三次元の角度になるのではないかと思われるかもしれませんが、実際に計算をしてみると似て非なる物になります。
\begin{gather}
\exp(xi)\exp(yj)\exp(zk)
\end{gather}

\section{四次元の回転計算は単純ではない}

四次元を四元数を使って回転させる事はできるのでしょうか？

まず、単純に複素数の回転の計算方法でどうなるのかを見てみましょう。
回転させたい四次元ベクトルを四元数で$h=h_0+h_1i+h_2j+h_3k$、
回転角を$\theta\in\mathbb{R}$、回転方向を$v\in\mathbb{V}$と定義すると、
回転後の単位四元数$h'=h_0'+h_1'i+h_2'j+h_3'k$は、
\begin{equation}
\begin{split}
x'=~&x\exp(\theta v)\\
h_0'+h_1'i+h_2'j+h_3'k=~&(h_0+h_1i+h_2j+h_3k)\exp(\theta v)
\end{split}
\end{equation}

となる事が期待されます。
この乗算では確かに矛盾なく循環するように見えますが、回転して欲しい方向以外の回転も含まれてしまうので、
捻りが加わってしまう事になります。
単位四元数の視覚化を使うと良く分かります。

より一般的な四元数による回転は等斜線分解(Isoclinic decomposition)により表現できると考えられています。
\begin{equation}
h_0'+h_1'i+h_2'j+h_3'k=\exp(au)(h_0+h_1i+h_2j+h_3k)\exp(bv),\quad a,b\in\mathbb{R},\quad u,v\in\mathbb{V}
\end{equation}

単位四元数を指数関数形式で表現しています。
2つの直交する回転面とその回転面上の2つの回転角により四次元の回転になるという事なので、
ベルソル$u,v$は直交し内積が$0$という条件が加わる事になると考えられます。
\begin{equation}
u \perp v \iff u \cdot v=0
\end{equation}

指数関数の式で表すと等斜線分解では回転として5つの角度になっているという事が分かります。
まず$u$を決めるのに2角度です。直交する$v$を決めるのに1角度で、角度$a,b$の合計で5角度です。

では、具体的にどのように回転面と回転角を解釈すれば良いのでしょうか？
三次元超球面を自由に航海したいのです。
この数式だけでは実用的な航海術としては満足できる物ではありません。
より詳しく調査を進めていきましょう。
まず四次元の2つ要素だけを考え、式を展開してみます。
まず以下のように素材を置きます。
\begin{gather}
h=h_0+h_1i+h_2j+h_3k \mapsto h'=h_0'+h_1'i+h_2'j+h_3'k\\
a^2+b^2=1,\quad a=\cos\frac{\theta}{2},\quad b=\sin\frac{\theta}{2},
\quad a,b,\theta\in\mathbb{R}
\end{gather}

倍角の公式から
\begin{equation}
a^2-b^2=\cos\theta,\quad 2ab=\sin\theta
\end{equation}

色々な組み合わせが考えられますが、以下について計算すると$h_3$から$h_2$方向への回転が得られます。
\begin{equation}
\begin{split}
&(a-bi)(h_0+h_1i+h_2j+h_3k)(a+bi)\\
=~&(ah_0+ah_1i+ah_2j+ah_3k-bh_0i+bh_1-bh_2k+bh_3j)(a+bi)\\
=~&a^2h_0+a^2h_1i+a^2h_2j+a^2h_3k-abh_0i+abh_1-abh_2k+abh_3j\\
&+abh_0i-abh_1-abh_2k+abh_3j+b^2h_0+b^2h_1i-b^2h_2j-b^2h_3k\\
=~&a^2h_0+abh_1-abh_1+b^2h_0+a^2h_1i-abh_0i+abh_0i+b^2h_1i\\
&+a^2h_2j+abh_3j+abh_3j-b^2h_2j+a^2h_3k-abh_2k-abh_2k-b^2h_3k\\
=~&a^2h_0+b^2h_0+a^2h_1i+b^2h_1i\\
&+a^2h_2j+2abh_3j-b^2h_2j+a^2h_3k-2abh_2k-b^2h_3k\\
=~&h_0+h_1i+((a^2-b^2)h_2+2abh_3)j+((a^2-b^2)h_3-2abh_2)k\\
=~&h_0+h_1i+(h_2\cos\theta+h_3\sin\theta)j+(h_3\cos\theta-h_2\sin\theta)k
\end{split}
\end{equation}

\begin{equation}
\begin{pmatrix}h_2'\\h_3'\end{pmatrix}
=\begin{pmatrix}\cos\theta&\sin\theta\\-\sin\theta&\cos\theta\end{pmatrix}
\begin{pmatrix}h_2\\h_3\end{pmatrix}
\end{equation}

同様に
\begin{equation}
\begin{split}
&(a-bj)(h_0+h_1i+h_2j+h_3k)(a+bj)\\
=~&(ah_0+ah_1i+ah_2j+ah_3k-bh_0j+bh_1k+bh_2-bh_3i)(a+bj)\\
=~&a^2h_0+a^2h_1i+a^2h_2j+a^2h_3k-abh_0j+abh_1k+abh_2-abh_3i\\
&+abh_0j+abh_1k-abh_2-abh_3i+b^2h_0-b^2h_1i+b^2h_2j-b^2h_3k\\
=~&a^2h_0+abh_2-abh_2+b^2h_0+a^2h_1i-abh_3i-abh_3i-b^2h_1i\\
&+a^2h_2j-abh_0j+abh_0j+b^2h_2j+a^2h_3k+abh_1k+abh_1k-b^2h_3k\\
=~&h_0+((a^2-b^2)h_1-2abh_3)i+h_2j+((a^2-b^2)h_3+2abh_1)k\\
=~&h_0+(h_1\cos\theta-h_3\sin\theta)i+h_2j+(h_3\cos\theta+h_1\sin\theta)k\\
\end{split}
\end{equation}

\begin{equation}
\begin{pmatrix}h_1'\\h_3'\end{pmatrix}
=\begin{pmatrix}\cos\theta&-\sin\theta\\\sin\theta&\cos\theta\end{pmatrix}
\begin{pmatrix}h_1\\h_3\end{pmatrix}
\end{equation}
$h_1$から$h_3$方向への回転になります。

\begin{equation}
\begin{split}
&(a-bk)(h_0+h_1i+h_2j+h_3k)(a+bk)\\
=~&(ah_0+ah_1i+ah_2j+ah_3k-bh_0k-bh_1j+bh_2i+bh_3)(a+bk)\\
=~&a^2h_0+a^2h_1i+a^2h_2j+a^2h_3k-abh_0k-abh_1j+abh_2i+abh_3\\
&+abh_0k-abh_1j+abh_2i-abh_3+b^2h_0-b^2h_1i-b^2h_2j+b^2h_3k\\
=~&a^2h_0+abh_3-abh_3+b^2h_0+a^2h_1i+abh_2i+abh_2i-b^2h_1i\\
&+a^2h_2j-abh_1j-abh_1j-b^2h_2j+a^2h_3k-abh_0k+abh_0k+b^2h_3k\\
=~&h_0+((a^2-b^2)h_1+2abh_2)i+((a^2-b^2)h_2-2abh_1)j+h_3k\\
=~&h_0+(h_1\cos\theta+h_2\sin\theta)i+(h_2\cos\theta-h_1\sin\theta)j+h_3k\\
\end{split}
\end{equation}

\begin{equation}
\begin{pmatrix}h_1'\\h_2'\end{pmatrix}
=\begin{pmatrix}\cos\theta&\sin\theta\\-\sin\theta&\cos\theta\end{pmatrix}
\begin{pmatrix}h_1\\h_2\end{pmatrix}
\end{equation}
$h_2$から$h_1$方向への回転になります。

この三つの回転角を座標軸$x,y,z$として移動を考えてみましょう。
\begin{gather}
x,y,z\in\mathbb{R}\\
e_x=\exp\left(\frac{x}{2}i\right)=\cos\frac{x}{2}+i\sin\frac{x}{2}=a_x+b_xi\\
e_y=\exp\left(\frac{y}{2}j\right)=\cos\frac{y}{2}+j\sin\frac{y}{2}=a_y+b_yj\\
e_z=\exp\left(\frac{z}{2}k\right)=\cos\frac{z}{2}+k\sin\frac{z}{2}=a_z+b_zk
\end{gather}

と置くと、任意の四元数$h$の$x,y,z$方向への移動とは
\begin{equation}
h'=e_z^*e_y^*e_x^*he_xe_ye_z
\end{equation}

四元数$h=h_0+h_1i+h_2j+h_3k$のベクトルパートについては$h_1^2+h_2^2+h_3^2>0$
の条件が有意な空間表現の為に必要なことが直ちに分かります。
つまり、スカラーパートだけの四元数から移動を開始する事ができません。
何か様子がおかしいですがこのまま進めてみます。
$h$のノルムについては特に制限はなさそうです。$h'$を実成分で展開してみます。
\begin{equation}
\begin{split}
e_z^*e_y^*e_x^*=~&(a_z-b_zk)(a_y-b_yj)(a_x-b_xi)\\
=~&(a_ya_z-a_zb_yj-a_yb_zk-b_yb_zi)(a_x-b_xi)\\
=~&a_xa_ya_z-a_ya_zb_xi-a_xa_zb_yj-a_zb_xb_yk-a_xa_yb_zk+a_yb_xb_zj-a_xb_yb_zi-b_xb_yb_z\\
=~&a_xa_ya_z-b_xb_yb_z-(a_xb_yb_z+a_ya_zb_x)i-(a_xa_zb_y-a_yb_xb_z)j-(a_xa_yb_z+a_zb_xb_y)k\\
\end{split}
\end{equation}

右側は
\begin{equation}
\begin{split}
e_xe_ye_z=~&(a_x+b_xi)(a_y+b_yj)(a_z+b_zk)\\
=~&(a_xa_y+a_xb_yj+a_yb_xi+b_xb_yk)(a_z+b_zk)\\
=~&a_xa_ya_z+a_xa_yb_zk+a_xa_zb_yj+a_xb_yb_zi+a_ya_zb_xi-a_yb_xb_zj+a_zb_xb_yk-b_xb_yb_z\\
=~&a_xa_ya_z-b_xb_yb_z+(a_xb_yb_z+a_ya_zb_x)i+(a_xa_zb_y-a_yb_xb_z)j+(a_xa_yb_z+a_zb_xb_y)k\\
\end{split}
\end{equation}

ここで
\begin{equation}
e_0=a_xa_ya_z-b_xb_yb_z,\quad e_1=a_xb_yb_z+a_ya_zb_x,\quad e_2=a_xa_zb_y-a_yb_xb_z,\quad e_3=a_xa_yb_z+a_zb_xb_y
\end{equation}

と置くと
\begin{equation}
h'=(e_0-e_1i-e_2j-e_3k)h(e_0+e_1i+e_2j+e_3k)
\end{equation}

互いに共役な四元数にまとまりました。さらに展開して
\begin{equation}
\begin{split}
e_z^*e_y^*e_x^*h=~&(e_0-e_1i-e_2j-e_3k)(h_0+h_1i+h_2j+h_3k)\\
=~&e_0h_0+e_0h_1i+e_0h_2j+e_0h_3k-e_1h_0i+e_1h_1-e_1h_2k+e_1h_3j\\
&-e_2h_0j+e_2h_1k+e_2h_2-e_2h_3i-e_3h_0k-e_3h_1j+e_3h_2i+e_3h_3\\
=~&e_0h_0+e_1h_1+e_2h_2+e_3h_3+(e_0h_1-e_1h_0-e_2h_3+e_3h_2)i\\
&+(e_0h_2+e_1h_3-e_2h_0-e_3h_1)j+(e_0h_3-e_1h_2+e_2h_1-e_3h_0)k\\
\end{split}
\end{equation}

\begin{equation}
\begin{split}
h'=~&(e_0h_0+e_1h_1+e_2h_2+e_3h_3+(e_0h_1-e_1h_0-e_2h_3+e_3h_2)i\\
&+(e_0h_2+e_1h_3-e_2h_0-e_3h_1)j+(e_0h_3-e_1h_2+e_2h_1-e_3h_0)k)(e_0+e_1i+e_2j+e_3k)\\
=~&e_0^2h_0+e_0e_1h_1+e_0e_2h_2+e_0e_3h_3+(e_0^2h_1-e_0e_1h_0-e_0e_2h_3+e_0e_3h_2)i\\
&+(e_0^2h_2+e_0e_1h_3-e_0e_2h_0-e_0e_3h_1)j+(e_0^2h_3-e_0e_1h_2+e_0e_2h_1-e_0e_3h_0)k\\
&+(e_0e_1h_0+e_1^2h_1+e_1e_2h_2+e_1e_3h_3)i-(e_0e_1h_1-e_1^2h_0-e_1e_2h_3+e_1e_3h_2)\\
&-(e_0e_1h_2+e_1^2h_3-e_1e_2h_0-e_1e_3h_1)k+(e_0e_1h_3-e_1^2h_2+e_1e_2h_1-e_1e_3h_0)j\\
&+(e_0e_2h_0+e_1e_2h_1+e_2^2h_2+e_2e_3h_3)j+(e_0e_2h_1-e_1e_2h_0-e_2^2h_3+e_2e_3h_2)k\\
&-(e_0e_2h_2+e_1e_2h_3-e_2^2h_0-e_2e_3h_1)-(e_0e_2h_3-e_1e_2h_2+e_2^2h_1-e_2e_3h_0)i\\
&+(e_0e_3h_0+e_1e_3h_1+e_2e_3h_2+e_3^2h_3)k-(e_0e_3h_1-e_1e_3h_0-e_2e_3h_3+e_3^2h_2)j\\
&+(e_0e_3h_2+e_1e_3h_3-e_2e_3h_0-e_3^2h_1)i-(e_0e_3h_3-e_1e_3h_2+e_2e_3h_1-e_3^2h_0)\\
=~&(e_0^2+e_1^2+e_2^2+e_3^2)h_0\\
&+((e_0^2+e_1^2-e_2^2-e_3^2)h_1+2(e_0e_3+e_1e_2)h_2+2(e_1e_3-e_0e_2)h_3)i\\
&+(2(e_1e_2-e_0e_3)h_1+(e_0^2-e_1^2+e_2^2-e_3^2)h_2+2(e_0e_1+e_2e_3)h_3)j\\
&+(2(e_0e_2+e_1e_3)h_1+2(e_2e_3-e_0e_1)h_2+(e_0^2-e_1^2-e_2^2+e_3^2)h_3)k\\
\end{split}
\end{equation}

ここで$e_0,e_1,e_2,e_3$の置き方から$e_0^2+e_1^2+e_2^2+e_3^2=1$なので
\begin{equation}
\begin{split}
h_0'=~&h_0\\
h_1'=~&(e_0^2+e_1^2-e_2^2-e_3^2)h_1+2(e_0e_3+e_1e_2)h_2+2(e_1e_3-e_0e_2)h_3\\
h_2'=~&2(e_1e_2-e_0e_3)h_1+(e_0^2-e_1^2+e_2^2-e_3^2)h_2+2(e_0e_1+e_2e_3)h_3\\
h_3'=~&2(e_0e_2+e_1e_3)h_1+2(e_2e_3-e_0e_1)h_2+(e_0^2-e_1^2-e_2^2+e_3^2)h_3\\
\end{split}
\end{equation}

$h,h'$は単位四元数ではないですが、ノルムは保存されます。
\begin{equation}
N(h')=N(h)
\end{equation}

$h_0'=h_0$なので
\begin{equation}
h_1'^2+h_2'^2+h_3'^2=h_1^2+h_2^2+h_3^2
\end{equation}

これは三次元内の球の表面の移動を意味しています。
四次元の計算のつもりが三次元になってしまいました。
この数式は三次元の回転計算としては有用そうです。
しかし、四次元の回転計算にはならない事が分かりました。

以上から等斜線分解の計算式で互いに共役な単位四元数を左右にセットすると三次元の回転になる事が、
実成分に展開して確認できましたが、求める航海術は得られませんでした。

\section{四元数の実軸からの回転}

改めて等斜線分解の計算式を考えてみます。
指数関数を使うと以下のように変形できます。
\begin{equation}
\begin{split}
N(h')\exp(\theta'w')=N(h)\exp(au)\exp(\theta w)\exp(bv)\\
a,b,\theta,\theta'\in\mathbb{R},\quad u,v,w,w'\in\mathbb{V}\\
\end{split}
\end{equation}

$N(h')=N(h)\in\mathbb{R}$なので結局は
\begin{equation}
\exp(\theta'w')=\exp(au)\exp(\theta w)\exp(bv)
\end{equation}

指数関数を外すと
\begin{equation}
\theta'w'=au+\theta w+bv
\end{equation}

ここで以下のように置いて
\begin{equation}
\begin{split}
u=u_1i+u_2j+u_3k,\quad v=v_1i+v_2j+v_3k,\quad w=w_1i+w_2j+w_3k\\
u,v\in\mathbb{V},\quad u_1,u_2,u_3,v_1,v_2,v_3,w_1,w_2,w_3\in\mathbb{R}
\end{split}
\end{equation}

実軸から$i$軸への回転だけを表すようになる条件は
\begin{equation}
\begin{split}
\theta'w_1'=~&au_1+\theta w_1+bv_1\\
\theta'w_2'=~&\theta w_2\\
\theta'w_3'=~&\theta w_3\\
\end{split}
\end{equation}

になるようにするのだから
\begin{gather}
au_2+bv_2=0 \quad\land\quad au_3+bv_3=0\iff au_2=-bv_2 \quad\land\quad au_3=-bv_3
\end{gather}

つまり以下のような$j,k$に関してだけ共役な単位四元数のペアによる変換式になります。
\begin{gather}
h'=\exp(au_1i-bv_2j-bv_3k)h\exp(bv_1i+bv_2j+bv_3k)
\end{gather}

直交条件から
\begin{equation}
\begin{split}
au_1bv_1-b^2v_2^2-b^2v_3^2=0\\
au_1v_1-bv_2^2-bv_3^2=0\\
au_1v_1-b(v_2^2+v_3^2)=0\\
au_1v_1-b(1-v_1^2)=0\\
bv_1^2+au_1v_1+b=0
\end{split}
\end{equation}

$v_1$が実数である条件は
\begin{gather}
a^2u_1^2-4b^2 \ge 0 \iff au_1 \ge 2b
\end{gather}

$a,b$が満たすべき条件がこれでしょうか？次に右側を$a$で置き換えてみます。
\begin{gather}
h'=\exp(au_1i+au_2j+au_3k)h\exp(bv_1i-au_2j-au_3k)
\end{gather}

直交条件から
\begin{equation}
\begin{split}
au_1bv_1-a^2u_2^2-a^2u_3^2=0\\
bu_1v_1-au_2^2-au_3^2=0\\
bu_1v_1-a(u_2^2+u_3^2)=0\\
bu_1v_1-a(1-u_1^2)=0\\
au_1^2+bu_1v_1+a=0
\end{split}
\end{equation}

$u_1$が実数である条件は
\begin{gather}
b^2v_1^2-4a^2 \ge 0 \iff bv_1 \ge 2a
\end{gather}

以上から実数$a,b$の条件をまとめると
\begin{equation}
au_1 \ge 2b \quad\land\quad bv_1 \ge 2a  \quad\land\quad u_1,v_1 \le 1
\end{equation}

これらを満たす実数$a,b$は存在しません。
従って、四元数の実軸から$i$軸にだけ回転させる計算は少なくとも単位四元数の回転計算の範囲には存在しないことになります。

\section{八元数の定義}

八元数は以下のように定義されます。
\begin{equation}
\texttt{Octonion}:\mathbb{O}\coloneq r_0+r_1e_1+r_2e_2+r_3e_3+r_4e_4+r_5e_5+r_6e_6+r_7e_7,
\quad r_0,...,r_7\in\mathbb{R}
\end{equation}

\begin{wraptable}{r}{8cm}
\caption{乗積表\label{octonion-multiplication-table}}
\centering
\begin{tabular}{rrrrrrrr}\hline
     & $e_1$& $e_2$& $e_3$& $e_4$& $e_5$& $e_6$& $e_7$\\\hline
$e_1$& $ -1$& $e_3$&-$e_2$& $e_5$&-$e_4$&-$e_7$& $e_6$\\\hline
$e_2$&-$e_3$& $ -1$& $e_1$& $e_6$& $e_7$&-$e_4$&-$e_5$\\\hline
$e_3$& $e_2$&-$e_1$& $ -1$& $e_7$&-$e_6$& $e_5$&-$e_4$\\\hline
$e_4$&-$e_5$&-$e_6$&-$e_7$& $ -1$& $e_1$& $e_2$& $e_3$\\\hline
$e_5$& $e_4$&-$e_7$& $e_6$&-$e_1$& $ -1$&-$e_3$& $e_2$\\\hline
$e_6$& $e_7$& $e_4$&-$e_5$&-$e_2$& $e_3$& $ -1$&-$e_1$\\\hline
$e_7$&-$e_6$& $e_5$& $e_4$&-$e_3$&-$e_2$& $e_1$& $ -1$\\\hline
\end{tabular}
\end{wraptable}

$e_1,...,e_7$の乗法は表\ref{octonion-multiplication-table}に従います。
乗法は順番を変えてはならず、3つ以上並んだ場合は左から順番に計算しないといけません。

乗積表には480通りのバリエーションがあり、ここではその一つを書いています。
しかし、その他の479通りの八元数についての本質的な違いはないと考えられています。
また、虚数単位$e_1,...,e_7$の書き方についても、$i,j,k,l$や$h,i,j,k$を組み合わせたりする事もあります。

八元数の共役$o^*$とノルム$N(o)$は以下のようになります。
\begin{equation}
\begin{split}
o=~&r_0+r_1e_1+r_2e_2+r_3e_3+r_4e_4+r_5e_5+r_6e_6+r_7e_7\\
o^*=~&r_0-r_1e_1-r_2e_2-r_3e_3-r_4e_4-r_5e_5-r_6e_6-r_7e_7\\
N(o)=~&o^*o=r_0^2+r_1^2+r_2^2+r_3^2+r_4^2+r_5^2+r_6^2+r_7^2
\end{split}
\end{equation}

八元数とは別に分解型八元数という物が定義できますが、それはまた別途触れたいと思います。

とりあえず、任意の八元数$o_0,o_1$の積をその実数成分で表現しておきます。
\begin{equation}
\begin{split}
o_0=~&p_0+p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
o_1=~&q_0+q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7
\end{split}
\end{equation}

$o_0o_1$を実直に計算しても良いですがスカラーパートを分ける事で少し楽をします。
\begin{equation}
\begin{split}
u=~&p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
v=~&q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7
\end{split}
\end{equation}

\begin{equation}
\begin{split}
o_0o_1=~&(p_0+u)(q_0+v)\\
=~&p_0q_0+p_0v+q_0u+uv
\end{split}
\end{equation}

\begin{equation}
\begin{split}
uv=~&(p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7)(q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7)\\
=~&p_1e_1q_1e_1+p_1e_1q_2e_2+p_1e_1q_3e_3+p_1e_1q_4e_4+p_1e_1q_5e_5+p_1e_1q_6e_6+p_1e_1q_7e_7\\
&+p_2e_2q_1e_1+p_2e_2q_2e_2+p_2e_2q_3e_3+p_2e_2q_4e_4+p_2e_2q_5e_5+p_2e_2q_6e_6+p_2e_2q_7e_7\\
&+p_3e_3q_1e_1+p_3e_3q_2e_2+p_3e_3q_3e_3+p_3e_3q_4e_4+p_3e_3q_5e_5+p_3e_3q_6e_6+p_3e_3q_7e_7\\
&+p_4e_4q_1e_1+p_4e_4q_2e_2+p_4e_4q_3e_3+p_4e_4q_4e_4+p_4e_4q_5e_5+p_4e_4q_6e_6+p_4e_4q_7e_7\\
&+p_5e_5q_1e_1+p_5e_5q_2e_2+p_5e_5q_3e_3+p_5e_5q_4e_4+p_5e_5q_5e_5+p_5e_5q_6e_6+p_5e_5q_7e_7\\
&+p_6e_6q_1e_1+p_6e_6q_2e_2+p_6e_6q_3e_3+p_6e_6q_4e_4+p_6e_6q_5e_5+p_6e_6q_6e_6+p_6e_6q_7e_7\\
&+p_7e_7q_1e_1+p_7e_7q_2e_2+p_7e_7q_3e_3+p_7e_7q_4e_4+p_7e_7q_5e_5+p_7e_7q_6e_6+p_7e_7q_7e_7\\
=~&-p_1q_1+p_1q_2e_3-p_1q_3e_2+p_1q_4e_5-p_1q_5e_4-p_1q_6e_7+p_1q_7e_6\\
&-p_2q_1e_3-p_2q_2+p_2q_3e_1+p_2q_4e_6+p_2q_5e_7-p_2q_6e_4-p_2q_7e_5\\
&+p_3q_1e_2-p_3q_2e_1-p_3q_3+p_3q_4e_7-p_3q_5e_6+p_3q_6e_5-p_3q_7e_4\\
&-p_4q_1e_5-p_4q_2e_6-p_4q_3e_7-p_4q_4+p_4q_5e_1+p_4q_6e_2+p_4q_7e_3\\
&+p_5q_1e_4-p_5q_2e_7+p_5q_3e_6-p_5q_4e_1-p_5q_5-p_5q_6e_3+p_5q_7e_2\\
&+p_6q_1e_7+p_6q_2e_4-p_6q_3e_5-p_6q_4e_2+p_6q_5e_3-p_6q_6-p_6q_7e_1\\
&-p_7q_1e_6+p_7q_2e_5+p_7q_3e_4-p_7q_4e_3-p_7q_5e_2+p_7q_6e_1-p_7q_7\\
=~&-p_1q_1-p_2q_2-p_3q_3-p_4q_4-p_5q_5-p_6q_6-p_7q_7\\
&+p_2q_3e_1-p_3q_2e_1+p_4q_5e_1-p_5q_4e_1-p_6q_7e_1+p_7q_6e_1\\
&-p_1q_3e_2+p_3q_1e_2+p_4q_6e_2+p_5q_7e_2-p_6q_4e_2-p_7q_5e_2\\
&+p_1q_2e_3-p_2q_1e_3+p_4q_7e_3-p_5q_6e_3+p_6q_5e_3-p_7q_4e_3\\
&-p_1q_5e_4-p_2q_6e_4-p_3q_7e_4+p_5q_1e_4+p_6q_2e_4+p_7q_3e_4\\
&+p_1q_4e_5-p_2q_7e_5+p_3q_6e_5+p_4q_1e_5-p_6q_3e_5+p_7q_2e_5\\
&+p_1q_7e_6+p_2q_4e_6-p_3q_5e_6-p_4q_2e_6+p_5q_3e_6-p_7q_1e_6\\
&-p_1q_6e_7+p_2q_5e_7+p_3q_4e_7-p_4q_3e_7-p_5q_2e_7+p_6q_1e_7
\end{split}
\end{equation}

\begin{equation}
\begin{split}
uv=~&-p_1q_1-p_2q_2-p_3q_3-p_4q_4-p_5q_5-p_6q_6-p_7q_7\\
&+(p_2q_3-p_3q_2+p_4q_5-p_5q_4+p_7q_6-p_6q_7)e_1\\
&+(p_3q_1-p_1q_3+p_4q_6-p_6q_4+p_5q_7-p_7q_5)e_2\\
&+(p_1q_2-p_2q_1+p_4q_7-p_7q_4+p_6q_5-p_5q_6)e_3\\
&+(p_5q_1-p_1q_5+p_6q_2-p_2q_6+p_7q_3-p_3q_7)e_4\\
&+(p_1q_4-p_4q_1+p_3q_6-p_6q_3+p_7q_2-p_2q_7)e_5\\
&+(p_1q_7-p_7q_1+p_2q_4-p_4q_2+p_5q_3-p_3q_5)e_6\\
&+(p_2q_5-p_5q_2+p_3q_4-p_4q_3+p_6q_1-p_1q_6)e_7
\end{split}
\end{equation}

\begin{equation}
\begin{split}
o_0o_1=~&p_0q_0-p_1q_1-p_2q_2-p_3q_3-p_4q_4-p_5q_5-p_6q_6-p_7q_7\\
&+(p_0q_1+p_1q_0+p_2q_3-p_3q_2+p_4q_5-p_5q_4+p_7q_6-p_6q_7)e_1\\
&+(p_0q_2+p_2q_0+p_3q_1-p_1q_3+p_4q_6-p_6q_4+p_5q_7-p_7q_5)e_2\\
&+(p_0q_3+p_3q_0+p_1q_2-p_2q_1+p_4q_7-p_7q_4+p_6q_5-p_5q_6)e_3\\
&+(p_0q_4+p_4q_0+p_5q_1-p_1q_5+p_6q_2-p_2q_6+p_7q_3-p_3q_7)e_4\\
&+(p_0q_5+p_5q_0+p_1q_4-p_4q_1+p_3q_6-p_6q_3+p_7q_2-p_2q_7)e_5\\
&+(p_0q_6+p_6q_0+p_1q_7-p_7q_1+p_2q_4-p_4q_2+p_5q_3-p_3q_5)e_6\\
&+(p_0q_7+p_7q_0+p_2q_5-p_5q_2+p_3q_4-p_4q_3+p_6q_1-p_1q_6)e_7
\end{split}
\end{equation}

$uv$は七次元の内積と外積の形をしていますので、七次元の角度や回転軸を計算する事ができると考えられます。
四元数を使って三次元の回転を計算できたように、八元数を使って七次元を回転できるのではないかと期待したい所です。
しかし、目下の所、四次元だけを回転させる計算方法を確立させたいので、まずは四次元に着目します。

\section{八元数による四次元の回転計算}

四次元ベクトル$(s_0,s_1,s_2,s_3)$を八元数の$e_4,e_5,e_6,e_7$に割り当てて回転計算を行ってみます。
\begin{equation}
s=s_0e_4+s_1e_5+s_2e_6+s_3e_7
\end{equation}

方向を表す四次元単位ベクトル$\bm{a},\bm{b}$があり、$\bm{a}$から$\bm{b}$の方向に$t\in\mathbb{R}$の割合だけ回転させます。
$\bm{a}$と$\bm{b}$が成す角度$\theta$を内積から求めます。
\begin{equation}
\begin{split}
\bm{a}=~&(a_0,a_1,a_2,a_3),\quad \bm{b}=~(b_0,b_1,b_2,b_3),\quad a_0,a_1,a_2,a_3,b_0,b_1,b_2,b_3\in\mathbb{R}\\
\theta=~&\arccos(\bm{a}\cdot\bm{b})=\arccos(a_0b_0+a_1b_1+a_2b_2+a_3b_3),\quad 0<\theta<\pi,\quad \theta\in\mathbb{R}
\end{split}
\end{equation}

回転軸を表す八元数を七次元の外積から求めます。
今$e_4,e_5,e_6,e_7$の内に四次元があると仮定しているので$\bm{a},\bm{b}$を以下の八元数に置き換えます。
\begin{equation}
a=a_0e_4+a_1e_5+a_2e_6+a_3e_7,\quad b=b_0e_4+b_1e_5+b_2e_6+b_3e_7
\end{equation}

積を計算し外積を抽出します。
\begin{equation}
\begin{split}
ab=~&-\cos\theta\\
&+(a_0b_1-a_1b_0+a_3b_2-a_2b_3)e_1\\
&+(a_0b_2-a_2b_0+a_1b_3-a_3b_1)e_2\\
&+(a_0b_3-a_3b_0+a_2b_1-a_1b_2)e_3
\end{split}
\end{equation}

$|a|=|b|=|ab|=1$なので以下であることが確認できます。
\begin{equation}
\begin{split}
\cos^2\theta+(a_0b_1-a_1b_0+a_3b_2-a_2b_3)^2+(a_0b_2-a_2b_0+a_1b_3-a_3b_1)^2+(a_0b_3-a_3b_0+a_2b_1-a_1b_2)^2=1\\
(a_0b_1-a_1b_0+a_3b_2-a_2b_3)^2+(a_0b_2-a_2b_0+a_1b_3-a_3b_1)^2+(a_0b_3-a_3b_0+a_2b_1-a_1b_2)^2=\sin^2\theta
\end{split}
\end{equation}

$e_1,e_2,e_3$の係数から八元数を構成し直して正規化しておきます。
\begin{gather}
w_1=\frac{a_0b_1-a_1b_0+a_3b_2-a_2b_3}{\sin\theta},\quad
w_2=\frac{a_0b_2-a_2b_0+a_1b_3-a_3b_1}{\sin\theta},\quad
w_3=\frac{a_0b_3-a_3b_0+a_2b_1-a_1b_2}{\sin\theta}\\
w=w_1e_1+w_2e_2+w_3e_3,\quad |w|=1
\end{gather}

こうして八元数より抽出した外積の``回転軸''$w$を観察してみると、元の軸$e_4,e_5,e_6,e_7$が構成する空間の外側にある
$e_1,e_2,e_3$軸が構成する空間で三次元として存在していると読み取れます。
従って、四次元を回転させる軸は七次元内の別の三次元に存在すると解釈できます。
四次元を四元数で回転させようとしても上手くいかなかった原因がここにありそうです。

他の軸の組み合わせはどうなるかが気なります。
7つのうち4つを選ぶ組み合わせの数は35通りあります。
$e_1,e_2,e_3,e_4$内に四次元を取ると
\begin{gather}
a=a_0e_1+a_1e_2+a_2e_3+a_3e_4,\quad b=b_0e_1+b_1e_2+b_2e_3+b_3e_4\\
ab+|ab|=(a_1b_2-a_2b_1)e_1+(a_2b_0-a_0b_2)e_2+(a_0b_1-a_1b_0)e_3+(a_0b_3-a_3b_0)e_5+(a_1b_3-a_3b_1)e_6+(a_2b_3-a_3b_2)e_7
\end{gather}
というように6軸になります。

どのような回転軸になるかは多様性と規則性がありそうですが、とりあえず回転計算を継続します。
以下のようにノルムが1の純虚八元数を七次元ベルソルとして定義しておきます。
\begin{equation}
\begin{split}
\texttt{Versor7}:\mathbb{V}_7\coloneq&\{d:d=\sqrt{-1},\quad d\in\mathbb{O}\}\\
=&\{d_1e_1+d_2e_2+d_3e_3+d_4e_4+d_5e_5+d_6e_6+d_7e_7,\quad d_1,d_2,d_3,d_4,d_5,d_6,d_7\in\mathbb{R},\quad |d|=1\}
\end{split}
\end{equation}

一般的に、四次元単位ベクトル$\bm{a},\bm{b}$を純虚八元数の係数のどれかに割り当てて七次元ベルソル$a,b$とした時、
これらを含む回転の回転軸を表す七次元ベルソル$w$は、$\bm{a},\bm{b}$が成す角度を$\theta$として、
\begin{equation}
w=\frac{ab+\cos\theta}{\sin\theta},\quad w\in\mathbb{V}_7
\end{equation}
となる事が見えてきました。
この回転軸によって回転を計算する為の八元数は以下のようになります。
\begin{equation}
o=\exp(-0.5t\theta w)=\cos 0.5t\theta-w\sin 0.5t\theta
\end{equation}
回転させたい四次元ベクトルを純虚八元数のいずれかに当てはめた八元数を$s$とすると、
回転後の四次元座標を示す八元数$s'$が以下のように算出される事が期待されます。
\begin{equation}
s'=o^*so
\end{equation}

実数成分で${}_7 \mathrm{C}_4=35$の組み合わせで展開してみるのは流石に冗長なので、コンピューターを使って計算をしてみましょう。
するとすべての組み合わせで、この回転計算の結果$s'$が$s$が選択した八元数の4つの軸による空間に戻ることが確認できます。
また、3Dグラフで視覚化をしてみると、確かに循環する輪が描かれる事が分かります。
循環する輪の形は(1)右回りにねじれる、(2)左回りにねじれる、(3)閉じている、(4)開いているの4種類あるようです。
これらの内、(1)(2)のねじれるパターンは、四元数の乗算と同じ形になっており、ねじれるという欠点があります。
そして、平行線を伸ばしたら合流してしまう(3)は除外できるでしょう。
(4)の開いているという回転のパターンが求める三次元超球面の移動だと考えられます。
しかし、これらの回転パターンは注目したある二次元の面にだけ成り立つ特徴があり、
三次元の移動を考えた時に3軸全てで(4)の開いているという形状をしているパターンは35種類の組み合わせの中には発見できません。
つまり、三次元超球面から切り取った原点を含む二次元面については回転計算が成立しますが、そこから外れる事ができません。

\section{分解型八元数の定義}

\begin{wraptable}{r}{8cm}
\caption{分解型八元数の乗積表\label{split-octonion-multiplication-table}}
\centering
\begin{tabular}{rrrrrrrr}\hline
     & $e_1$& $e_2$& $e_3$& $e_4$& $e_5$& $e_6$& $e_7$\\\hline
$e_1$& $ -1$& $e_3$&-$e_2$&-$e_5$& $e_4$&-$e_7$& $e_6$\\\hline
$e_2$&-$e_3$& $ -1$& $e_1$&-$e_6$& $e_7$& $e_4$&-$e_5$\\\hline
$e_3$& $e_2$&-$e_1$& $ -1$&-$e_7$&-$e_6$& $e_5$& $e_4$\\\hline
$e_4$& $e_5$& $e_6$& $e_7$& $  1$& $e_1$& $e_2$& $e_3$\\\hline
$e_5$&-$e_4$&-$e_7$& $e_6$&-$e_1$& $  1$& $e_3$&-$e_2$\\\hline
$e_6$& $e_7$&-$e_4$&-$e_5$&-$e_2$&-$e_3$& $  1$& $e_1$\\\hline
$e_7$&-$e_6$& $e_5$&-$e_4$&-$e_3$& $e_2$&-$e_1$& $  1$\\\hline
\end{tabular}
\end{wraptable}

分解型八元数についても可能性を調査してみましょう。
分解型八元数は以下のように定義されます。
\begin{multline}
\texttt{Split-octonion}:\\
\mathbb{O}_s\coloneq r_0+r_1e_1+r_2e_2+r_3e_3+r_4e_4+r_5e_5+r_6e_6+r_7e_7\\
\quad r_0,...,r_7\in\mathbb{R}
\end{multline}

$e_1,...,e_7$の乗法は表\ref{split-octonion-multiplication-table}に従います。

共役は八元数と同じ定義です。
\begin{equation}
\begin{split}
s=~&r_0+r_1e_1+r_2e_2+r_3e_3+r_4e_4+r_5e_5+r_6e_6+r_7e_7\\
s^*=~&r_0-r_1e_1-r_2e_2-r_3e_3-r_4e_4-r_5e_5-r_6e_6-r_7e_7
\end{split}
\end{equation}

ノルムについては少し様子が違って以下のようになります。
\begin{equation}
\begin{split}
N(s)=s^*s=(r_0^2+r_1^2+r_2^2+r_3^2)-(r_4^2+r_5^2+r_6^2+r_7^2)
\end{split}
\end{equation}
八元数同様に乗積表の右上と左下の符号が反転しているので共役をかけるとそれらが消えて実数部分のみになります。

まず、任意の分解型八元数$s_0,s_1$の積をその実数成分で表現しておきましょう。
\begin{equation}
\begin{split}
s_0=~&p_0+p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
s_1=~&q_0+q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7
\end{split}
\end{equation}

スカラーパートを分けておきます。
\begin{equation}
\begin{split}
u=~&p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
v=~&q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7
\end{split}
\end{equation}

\begin{equation}
\begin{split}
s_0s_1=~&(p_0+u)(q_0+v)\\
=~&p_0q_0+p_0v+q_0u+uv
\end{split}
\end{equation}

\begin{equation}
\begin{split}
uv=~&(p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7)(q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7)\\
=~&p_1e_1q_1e_1+p_1e_1q_2e_2+p_1e_1q_3e_3+p_1e_1q_4e_4+p_1e_1q_5e_5+p_1e_1q_6e_6+p_1e_1q_7e_7\\
&+p_2e_2q_1e_1+p_2e_2q_2e_2+p_2e_2q_3e_3+p_2e_2q_4e_4+p_2e_2q_5e_5+p_2e_2q_6e_6+p_2e_2q_7e_7\\
&+p_3e_3q_1e_1+p_3e_3q_2e_2+p_3e_3q_3e_3+p_3e_3q_4e_4+p_3e_3q_5e_5+p_3e_3q_6e_6+p_3e_3q_7e_7\\
&+p_4e_4q_1e_1+p_4e_4q_2e_2+p_4e_4q_3e_3+p_4e_4q_4e_4+p_4e_4q_5e_5+p_4e_4q_6e_6+p_4e_4q_7e_7\\
&+p_5e_5q_1e_1+p_5e_5q_2e_2+p_5e_5q_3e_3+p_5e_5q_4e_4+p_5e_5q_5e_5+p_5e_5q_6e_6+p_5e_5q_7e_7\\
&+p_6e_6q_1e_1+p_6e_6q_2e_2+p_6e_6q_3e_3+p_6e_6q_4e_4+p_6e_6q_5e_5+p_6e_6q_6e_6+p_6e_6q_7e_7\\
&+p_7e_7q_1e_1+p_7e_7q_2e_2+p_7e_7q_3e_3+p_7e_7q_4e_4+p_7e_7q_5e_5+p_7e_7q_6e_6+p_7e_7q_7e_7\\
=~&-p_1q_1+p_1q_2e_3-p_1q_3e_2-p_1q_4e_5+p_1q_5e_4-p_1q_6e_7+p_1q_7e_6\\
&-p_2q_1e_3-p_2q_2+p_2q_3e_1-p_2q_4e_6+p_2q_5e_7+p_2q_6e_4-p_2q_7e_5\\
&+p_3q_1e_2-p_3q_2e_1-p_3q_3-p_3q_4e_7-p_3q_5e_6+p_3q_6e_5+p_3q_7e_4\\
&+p_4q_1e_5+p_4q_2e_6+p_4q_3e_7+p_4q_4+p_4q_5e_1+p_4q_6e_2+p_4q_7e_3\\
&-p_5q_1e_4-p_5q_2e_7+p_5q_3e_6-p_5q_4e_1+p_5q_5+p_5q_6e_3-p_5q_7e_2\\
&+p_6q_1e_7-p_6q_2e_4-p_6q_3e_5-p_6q_4e_2-p_6q_5e_3+p_6q_6+p_6q_7e_1\\
&-p_7q_1e_6+p_7q_2e_5-p_7q_3e_4-p_7q_4e_3+p_7q_5e_2-p_7q_6e_1+p_7q_7\\
=~&-p_1q_1-p_2q_2-p_3q_3+p_4q_4+p_5q_5+p_6q_6+p_7q_7\\
&+(p_2q_3-p_3q_2+p_4q_5-p_5q_4+p_6q_7-p_7q_6)e_1\\
&+(p_3q_1-p_1q_3+p_4q_6-p_6q_4+p_7q_5-p_5q_7)e_2\\
&+(p_1q_2-p_2q_1+p_4q_7-p_7q_4+p_5q_6-p_6q_5)e_3\\
&+(p_1q_5-p_5q_1+p_2q_6-p_6q_2+p_3q_7-p_7q_3)e_4\\
&+(p_3q_6-p_6q_3+p_4q_1-p_1q_4+p_7q_2-p_2q_7)e_5\\
&+(p_1q_7-p_7q_1+p_4q_2-p_2q_4+p_5q_3-p_3q_5)e_6\\
&+(p_2q_5-p_5q_2+p_4q_3-p_3q_4+p_6q_1-p_1q_6)e_7\\
\end{split}
\end{equation}
この展開された式は八元数の七次元の外積とは別物のようです。何を表すのでしょうか？
掘り下げて調査する必要がありそうです。

\section{分解型八元数の角度}

分解型八元数に内在する角度がオイラーの公式からどうなるかを調べましょう。
\begin{equation}
s_L=~r_0+r_1e_1+r_2e_2+r_3e_3,\quad s_R=r_4e_4+r_5e_5+r_6e_6+r_7e_7
\end{equation}
というように分解すると$s_L$は四元数と同様になり、$r_1^2+r_2^2+r_3^2\ne 0$の時、
\begin{equation}
\alpha v_L=r_1e_1+r_2e_2+r_3e_3,\quad v_L^2=-1,\quad \alpha\in\mathbb{R}
\end{equation}
と置いて、
\begin{equation}
\exp(s_L)=\exp(r_0+\alpha v_L)=\exp(r_0)(\cos \alpha+v_L\sin\alpha)
\end{equation}
$s_R$については、$|s_R|\ne 0$の時、
\begin{equation}
\beta v_R=r_4e_4+r_5e_5+r_6e_6+r_7e_7,\quad v_R^2=+1,\quad \beta\in\mathbb{R}
\end{equation}
と置くと、分解型複素数のオイラーの公式から、
\begin{equation}
\exp(s_R)=\exp(\beta v_R)=\cosh \beta+v_R\sinh \beta
\end{equation}
従って、分解型八元数の角度表現は以下のようになります。
\begin{equation}
\begin{split}
\exp(s)=~&\exp(s_L+s_R)=\exp(s_L)\exp(s_R)
=\exp(r_0)(\cos\alpha+v_L\sin\alpha)(\cosh\beta+v_R\sinh\beta)
\end{split}
\end{equation}
純虚分解型八元数について書き直すと、
\begin{equation}
\exp(s)=\exp(\alpha v_L+\beta v_R)=(\cos\alpha+v_L\sin\alpha)(\cosh\beta+v_R\sinh\beta),\quad r_0=0
\end{equation}
以下のように展開してみます。
\begin{equation}
\exp(s)=\cos\alpha\cosh\beta+v_Lv_R\sin\alpha\sinh\beta+v_L\sin\alpha\cosh\beta+v_R\cos\alpha\sinh\beta
\end{equation}
複素数による三角関数と加法定理より、$I^2=-1$という別の虚数単位を導入して、
\begin{equation}
\begin{split}
\cos(\alpha-I\beta)=~&\cos\alpha\cos I\beta+\sin\alpha\sin I\beta\\
=~&\cos\alpha\cosh\beta+I\sin\alpha\sinh\beta\\
\sin(\alpha-I\beta)=~&\sin\alpha\cos I\beta-\cos\alpha\sin I\beta\\
=~&\sin\alpha\cosh\beta-I\cos\alpha\sinh\beta\\
\end{split}
\end{equation}
さらに$J^2=-1$という別の虚数単位を導入すると、
\begin{equation}
J\sin(\alpha-I\beta)=J\sin\alpha\cosh\beta-JI\cos\alpha\sinh\beta
\end{equation}
$I=v_Lv_R,J=v_L$というように当てはめると、
\begin{equation}
\begin{split}
\exp(s)=~&\cos\alpha\cosh\beta+v_Lv_R\sin\alpha\sinh\beta+v_L\sin\alpha\cosh\beta-v_Lv_Lv_R\cos\alpha\sinh\beta\\
=~&\cos(\alpha-v_Lv_R\beta)+v_L\sin(\alpha-v_Lv_R\beta)\\
=~&\exp(v_L(\alpha-v_Lv_R\beta))\\
=~&\exp(v_L\alpha+v_R\beta)\\
=~&\exp(s)\\
\end{split}
\end{equation}
元に戻ります。ここで$\theta=\alpha-v_Lv_R\beta$と置けば、四元数のオイラーの公式と同じ形が得られます。
\begin{equation}
\exp(v_L\theta)=\cos\theta+v_L\sin\theta
\end{equation}

\section{純虚分解型八元数の指数関数}

改めて純虚分解型八元数を以下のように定義し直します。
\begin{equation}
\begin{split}
\exp(s)=~&\exp(\alpha u+\beta v)=p_0+p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
&\alpha,\beta,p_0,...,p_7\in\mathbb{R}\\
u=~&a_1e_1+a_2e_2+a_3e_3,\quad a_1^2+a_2^2+a_3^2=1\\
v=~&a_4e_4+a_5e_5+a_6e_6+a_7e_7,\quad a_4^2+a_5^2+a_6^2+a_7^2=1\\
&a_1,...,a_7\in\mathbb{R}\\
\end{split}
\end{equation}
$p_0,...,p_7$を角度と方向からなる実数で表現してみましょう。
\begin{equation}
\begin{split}
\exp(s)=~&(\cos\alpha+u\sin\alpha)(\cosh\beta+v\sinh\beta)\\
=~&\cos\alpha\cosh\beta+uv\sin\alpha\sinh\beta+u\sin\alpha\cosh\beta+v\cos\alpha\sinh\beta\\
\end{split}
\end{equation}
$uv$を先に展開して、
\begin{equation}
\begin{split}
uv=~&(a_1e_1+a_2e_2+a_3e_3)(a_4e_4+a_5e_5+a_6e_6+a_7e_7)\\
=~&(a_1a_5+a_2a_6+a_3a_7)e_4\\
&+(a_3a_6-a_1a_4-a_2a_7)e_5\\
&+(a_1a_7-a_2a_4-a_3a_5)e_6\\
&+(a_2a_5-a_3a_4-a_1a_6)e_7\\
\end{split}
\end{equation}
$e_1,e_2,e_3$の項が消えてしまうのが印象的です。
\begin{equation}
\begin{split}
\exp(s)=~&\cos\alpha\cosh\beta+a_1e_1\sin\alpha\cosh\beta+a_2e_2\sin\alpha\cosh\beta+a_3e_3\sin\alpha\cosh\beta\\
&+((a_1a_5+a_2a_6+a_3a_7)\sin\alpha+a_4\cos\alpha)e_4\sinh\beta\\
&+((a_3a_6-a_1a_4-a_2a_7)\sin\alpha+a_5\cos\alpha)e_5\sinh\beta\\
&+((a_1a_7-a_2a_4-a_3a_5)\sin\alpha+a_6\cos\alpha)e_6\sinh\beta\\
&+((a_2a_5-a_3a_4-a_1a_6)\sin\alpha+a_7\cos\alpha)e_7\sinh\beta\\
\end{split}
\end{equation}

\begin{equation}
\begin{split}
p_0=~&\cos\alpha\cosh\beta\\
p_1=~&a_1\sin\alpha\cosh\beta\\
p_2=~&a_2\sin\alpha\cosh\beta\\
p_3=~&a_3\sin\alpha\cosh\beta\\
p_4=~&((a_1a_5+a_2a_6+a_3a_7)\sin\alpha+a_4\cos\alpha)\sinh\beta\\
p_5=~&((a_3a_6-a_1a_4-a_2a_7)\sin\alpha+a_5\cos\alpha)\sinh\beta\\
p_6=~&((a_1a_7-a_2a_4-a_3a_5)\sin\alpha+a_6\cos\alpha)\sinh\beta\\
p_7=~&((a_2a_5-a_3a_4-a_1a_6)\sin\alpha+a_7\cos\alpha)\sinh\beta\\
\end{split}
\end{equation}

\section{分解型八元数による回転}

分解型八元数に内在する角度が2つある事が分かってきました。
方向を表す2つのベクトルもあります。
三次元単位ベクトルと四次元単位ベクトルです。
これらが組み合わさって七次元を構成しています。

2つの純虚分解型八元数$u,v$を以下のように定義して回転を計算してみます。
\begin{equation}
\begin{split}
u=~&p_1e_1+p_2e_2+p_3e_3+p_4e_4+p_5e_5+p_6e_6+p_7e_7\\
&p_1^2+p_2^2+p_3^2=1,\quad p_4^2+p_5^2+p_6^2+p_7^2=1\\
v=~&q_1e_1+q_2e_2+q_3e_3+q_4e_4+q_5e_5+q_6e_6+q_7e_7\\
&q_1^2+q_2^2+q_3^2=1,\quad q_4^2+q_5^2+q_6^2+q_7^2=1\\
\cos\alpha=~&p_1q_1+p_2q_2+p_3q_3\\
\cos\beta=~&p_4q_4+p_5q_5+p_6q_6+p_7q_7\\
\end{split}
\end{equation}
$u,v$のノルムは$0$になります。
\begin{equation}
N(u)=N(v)=N(uv)=0
\end{equation}
積の計算結果から、
\begin{equation}
uv=-\cos\alpha+\cos\beta+s
\end{equation}
となるように$s$を置くと、
\begin{gather}
N(uv)=(-\cos\alpha+\cos\beta)^2+N(s)=0\\
N(s)=-(-\cos\alpha+\cos\beta)^2
\end{gather}
というような関係性が見られます。回転軸$w$は、
\begin{equation}
\begin{split}
&s=s_1e_1+s_2e_2+s_3e_3+s_4e_4+s_5e_5+s_6e_6+s_7e_7\\
&s_L=s_1e_1+s_2e_2+s_3e_3,\quad s_R=s_4e_4+s_5e_5+s_6e_6+s_7e_7\\
\end{split}
\end{equation}
として、
\begin{equation}
\begin{split}
w_L=~&\frac{s_L}{|s_L|},\quad w_R=\frac{s_R}{|s_R|}\\
w=~&w_L+w_R,\quad N(w)=0\\
\end{split}
\end{equation}
回転子$\rho$は、$w_L$方向に$a\alpha$、$w_R$方向に$b\beta$回転させるとして、
\begin{equation}
\rho=\exp(-0.5a\alpha w_L+b\beta w_R)=(\cos 0.5a\alpha-w_L\sin0.5a\alpha)(\cosh 0.5b\beta-w_R\sinh 0.5b\beta)
\end{equation}
純虚分解型八元数$f$を回転させて$f'$になるとすると、
\begin{equation}
\begin{split}
f'=~&\rho^*f\rho\\
=~&(\cosh 0.5b\beta+w_R\sinh 0.5b\beta)(\cos 0.5a\alpha+w_L\sin0.5a\alpha)f
(\cos 0.5a\alpha-w_L\sin0.5a\alpha)(\cosh 0.5b\beta-w_R\sinh 0.5b\beta)
\end{split}
\end{equation}

\chapter{多体シミュレーションにおける物理法則}

\section{時間進捗の考え方の導入}

多体物理シミュレーションに適用する物理法則を考えるに当たって、最も重要な事は時間に対する考え方になります。
通常の物理方程式の解の求め方では、時間を連続した直線的な概念として把握します。
時間を直線的な$t$のパラメーターとして考えてある時刻を$t$に当てはめれば、どんな未来も過去も物理的実体を厳密に算出する事ができます。

しかし、このような物理方程式を多体について厳密に解いていく事は不可能です。
コンピューターによる多体シミュレーションでは時間は非連続的であると考えます。
フィルム映画やアニメーションのようにコマ送りで物理法則を計算していきます。
計算する内容は現在の物理的パラメーターに基づいた次の瞬間の物理パラメーターの遷移についてだけです。

このシミュレーションの方法では任意に時刻を指定して状態を厳密に算出する事はできません。
もし任意の時刻の状態を知りたいのであれば、一度知りたい時刻の範囲の計算を行っておいて、そのデータを全部記録しておく事になります。

\section{時間進捗で計算する内容}

全ての物体が分解したり合体したりしないで総数が一定の粒子であるとすれば、
それぞれの粒子について位置と運動量をデータとして持っておき、それらの相互作用を計算することで多体シミュレーションを成立させます。
具体的に行う計算には2種類あります。

一つは、状態変化の計算になります。
具体的には速度を位置の変化に反映させる計算になります。
$N$体あれば$N$回の計算で済みます。

もう一つは、他の粒子との相互作用になります。
この計算は、$N$体あれば$N(N-1)/2$回の計算になり、計算量オーダー的に$O(n^2)$となりますので、粒子数が増えると計算量が激増します。
具体的には、運動量の交換がこの相互作用で行われます。

\chapter{クリフォード代数による一般相対性理論}

\section{四元数の直積}

双四元数は四元数の係数を複素数にしましたが、同じように係数を四元数にしてみます。
四元数としてお互いに干渉しない虚数単位のセットを2つ定義します。
\begin{gather}
i^2=j^2=k^2=-1\\
I^2=J^2=K^2=-1\\
ij=k,~jk=i,~ki=j,~ji=-k,~kj=-i,~ik=-j\\
IJ=K,~JK=I,~KI=J,~JI=-K,~KJ=-I,~IK=-J\\
iI=Ii,~jI=Ij,~kI=Ik\\
iJ=Ji,~jJ=Jj,~kJ=Jk\\
iK=Ki,~jK=Kj,~kK=Kk
\end{gather}
これらを組み合わせて2つの四元数の直積を作りますが、利便性の為に以後「四双四元数」(クアクォータニオン)と呼称します。
\begin{equation}
\begin{split}
\texttt{Quaquaternion}:\mathbb{H}\otimes\mathbb{H}\coloneq ~&a+bi+cj+dk+m+ni+rj+sk\\
&a,b,c,d\in\mathbb{R}\\
&m=m_1I+m_2J+m_3K,\quad m_1,m_2,m_3\in\mathbb{R}\\
&n=n_1I+n_2J+n_3K,\quad n_1,n_2,n_3\in\mathbb{R}\\
&r=r_1I+r_2J+r_3K,\quad r_1,r_2,r_3\in\mathbb{R}\\
&n=s_1I+s_2J+s_3K,\quad s_1,s_2,s_3\in\mathbb{R}
\end{split}
\end{equation}
部分に以下のような呼称があります。\\
スカラーパート：$a$、疑似スカラーパート：$bi$\\
ベクトルパート：$cj+sk$、バイベクトルパート：$m+ni$、トリベクトルパート：$dk+rj$\\

\section{四双四元数による四次元擬ユークリッド空間}

\chapter{角度空間での歪み}

物理量として角度のみを使用する場合に、時空の歪みがどう表現されるのかを考えます。

\section{一次元の角度の歪み}

まず、一次元の角度の歪みがどうなるかを考えます。単位円を思い描きましょう。
この円が歪むとすれば、普通は山あり谷ありにした円になると考えると思います。
円の半径を伸ばしたり縮んだりさせれば、それが歪みではないかという事です。
しかし、この描像では角度以外の長さという概念を使用してしまっています。
長さという概念を持たせないで円を歪ませるには、円に二次元平面を飛び出してもらって、三次元の別方向に歪んでもらうしかありません。

同様に四次元時空が歪んでいく場合について考察すると、その歪みは四次元時空外の高次元領域にはみ出ていくと考えられます。
その高次元領域を探求するに当たって、クリフォード代数がより計算可能範囲の広い視点をもたらしてくれるのではないかと期待する訳です。

\section{歪みの限界突破}

一次元の角度の歪みの話に戻ります。
$XY$平面に描かれた円が$Z$軸方向に球面を歪んでいく事を想像してください。
この歪みがどんどんと広がっていき、終には$180\tcdegree$を超える時にはどうなってしまうでしょうか？

ここで一つの仮定を導入します。
歪みが$180\tcdegree$を超える時、歪みの方向が急に逆向きになって反対の方に歪むとします。
このように取り決めておくと、歪みをどんどん加算していっても計算が破綻する事がありません。
この歪みの$180\tcdegree$の部分を今度は四次元時空に拡張して考えてみましょう。
すると到達できる限界であるという意味からすると、一般相対性理論が想定した事象の地平面と同様であると考えられる訳です。
そこでいっその事、事象の地平面の向こう側では重力が反転してしまうと考えます。
つまり、ブラックホールの内側に入った途端に進行方向が逆転して跳ね返されるという事を言っています。
従来の認識では考えられないと思いますが、シミュレーションしてみた結果を見ながら考察してみます。

\section{事象の地平面での重力反転がもたらす事象}

赤色巨星が重力崩壊を起こして巨大な質量体が中心に向かって圧縮されていく過程を考えます。
ある程度まで圧縮されると集合した物質による強大な重力により、その塊のどこかに事象の地平面が出現する事になるでしょう。

重力反転仮説に沿って思考を進めると、事象の地平面出現により、強力な重力反転場が突然出現する事になります。
外側から重力崩壊で中心に向かっている粒子と、重力反転した粒子が激的な衝突を起こすと考えられます。
もしくは、事象の地平面によって粒子がすり潰されるのかもしれません。
結果としては、巨大な質量が一気にエネルギーに変換される事になるでしょう。
超新星爆発の原因として十分に考えられるエネルギー量になりそうです。

この時出現したブラックホールは、質量体が爆散してしまう事により必然的に一旦は消滅してしまいます。
爆散の原因の大部分は質量から変換されたエネルギーによるものではなく、重力反転による自己軌道によるものになるでしょう。
再度爆散した質量体が集まってくれば何度も超新星爆発が引き起こされる事になります。
何度か超新星爆発を繰り返した後に、安定したブラックホールができあがります。
質量が大きければ大きいほど繰り返す爆発の回数は多くなります。
また、ブラックホールは大抵は同時に2つできるとシミュレーションでは示されています。

\section{重力反転するも結局はブラックホールになる謎}

事象の地平面が出現する時に重力反転の現象があるとすると、粒子が集合しても塊にはならないと思うかもしれませんが、
シミュレーションでは条件を整えれば粒子は塊を形成し、ある一定の範囲から外に出てくる事が無くなります。
期待したようなブラックホールが形成されるわけです。
ブラックホール形成が起きるまでに高次元領域でどんな事象が起きているのかは今後さらに調査する必要があります。

ブラックホール内の粒子はある一定の球状の範囲の内部を無秩序に飛び回ります。
実際のブラックホールもこのように超高温になっていると考えらます。
時空の歪みにより光さえも外に出てこないので外からは何も観測できないのでしょう。
何も出てこなくなるという結果は重力反転仮説でも同じです。

ブラックホールについて誤解してはいけないのは、一般的に球状の質量体の中心部分には重力は働いていないという事です。
ブラックホールの中心部に無限に強くなっていく重力場があると思ってはいけません。
この事について十分に考えて良く了解してください。
例えば地球の重力を考えましょう。
重力が一番強く働いているのは地表になります。
地下に向かって穴を掘って降下していくと、徐々に重力が弱くなって行きます。
マグマの影響を受けずに地球の中心に到達できたとすれば、わずかな揺らぎを無視すれば無重力になります。
地球の中心では周囲に均等に質量体があるからです。

一般的にどんな星であっても、時空の歪みが最も強くなるのは球体の表面であり中心部分は歪みは少ないのです。
事象の地平面を持つブラックホールでも中心部分は無重力になっていると考えられます。

ブラックホール形成のプロセスでは事象の地平面は動的です。
事象の地平面が中心部から一気に拡大する事も考えられますが、粒子の集合の周辺部分こそ重力が最も強くなることを考慮すると、
実際はもっと複雑な動きをしていそうです。
重力反転があるという事を考慮すると、ブラックホール形成には、ある程度の勢いをもって周囲から一気に物質が集まらなければならない事が分かります。

\section{双極性星雲は双子のブラックホール仮説}

条件さえそろえば、多くの場合、赤色巨星の崩壊から双子のブラックホールが形成される事になります。
重力反転仮説では、同時に形成された2つのブラックホールは一気に合体するという事は起きないと考えます。
また、形成時にお互いに速度があるわけではないので回転が起きることも考えにくいです。
重力反転の場がお互いの周囲に形成されているので、まるで絶対空間にピン止めされているようになります。
そして、周囲に独特の粒子の奔流を作り出します。
この相対したブラックホールの作り出す奔流が双極性星雲になっていると考えられます。

\section{パルサーはブラックホール仮説}

事象の地平面に重力反転がある事によりブラックホール表面では粒子が縦振動をすると考えられます。
表面の粒子が縦振動をすると星の密度が変動するので、伴って事象の地平面の大きさも変動する事になります。
事象の地平面の大きさが変わると表面の粒子の縦振動が揃うので、星全体で一斉に振動する事になります。
その結果、ブラックホール表面から周期的に強力なパルスが発せられるようになると考えられます。
そして実際にこの現象を起こしている天体がパルサーであると予想します。

パルサーは高速回転をする天体であると仮定していては説明できない現象もあります。
ブラックホール表面での重力反転仮説では良く説明できる可能性があります。

パルサーのエネルギー源がその表面物質の質量であり、その全てがエネルギーに変換されるまで膨大なエネルギーを宇宙に放射し続ける能力があると考えると、
計算不可能なほどの膨大なエネルギー源に説明が付きます。
しばしば強力なバーストを起こす事についても、他の天体を吸収し同化した時に起きる現象として説明できます。

\chapter{多元数の微分積分}




\end{document}